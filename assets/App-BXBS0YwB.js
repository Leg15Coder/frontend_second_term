const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Cnf75vxI.js","assets/vendor-CEayKMPr.js","assets/index-BkCjgTNj.css"])))=>i.map(i=>d[i]);
import{N as c,O as Ut,Q as Vt,R as Ht,M as e,S as Ws,U as Ve,V as Bs,W as Js,X as Ys,Y as bs,Z as Ks,_ as Zs,$ as zt,a0 as Wt,a1 as Xs,a2 as U,a3 as Bt,a4 as ke,a5 as Qs,a6 as et,a7 as Ns,a8 as ie,a9 as le,aa as Jt,ab as Yt,ac as st,ad as Kt,ae as Zt,af as Xt,ag as d,ah as ws,ai as vs,aj as ys,ak as Ne,al as Ze,am as Ee,an as $e,ao as ks,ap as Qt,aq as ea,ar as qe,as as tt,at as Xe,au as Qe,av as sa,aw as Cs,ax as at,ay as Ss,az as ls,aA as is,aB as ps,aC as ta,aD as aa,aE as ra,aF as la,aG as ia,aH as na,aI as ca,aJ as oa,aK as da,aL as Is,aM as xa,aN as ma,aO as ha,aP as ua,aQ as pa,aR as ga,aS as rt,aT as fa,aU as lt,aV as it,aW as nt,aX as ja,aY as ba,aZ as ct,a_ as Na,a$ as ot,b0 as wa,b1 as dt,b2 as va,b3 as xt,b4 as ya,b5 as ka,b6 as mt,b7 as Ca,b8 as ht,b9 as ut,ba as pt,bb as Ms,bc as Sa,bd as Ta,be as Da,bf as Ea,bg as _a,bh as Ra,bi as O}from"./vendor-CEayKMPr.js";import{u as X,a as Y,s as Be,b as q,f as Ts,c as gt,d as ft,l as jt,j as bt,e as Nt,g as _e,h as Je,i as gs,_ as de,k as wt,t as vt,m as yt,n as kt,o as Ct,p as St,q as $a,r as Pa,v as La,w as Fs,x as Ia,y as Ma,z as Fa,A as Tt,B as Os,C as Oa,D as Aa,E as qa,F as Ga,G as Ua}from"./index-Cnf75vxI.js";const Va=1,Ha=1e6;let ns=0;function za(){return ns=(ns+1)%Number.MAX_SAFE_INTEGER,ns.toString()}const cs=new Map,As=t=>{if(cs.has(t))return;const s=setTimeout(()=>{cs.delete(t),Ae({type:"REMOVE_TOAST",toastId:t})},Ha);cs.set(t,s)},Wa=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,Va)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(a=>a.id===s.toast.id?{...a,...s.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=s;return a?As(a):t.toasts.forEach(r=>{As(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===a||a===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==s.toastId)}}},He=[];let ze={toasts:[]};function Ae(t){ze=Wa(ze,t),He.forEach(s=>{s(ze)})}function Ba({...t}){const s=za(),a=l=>Ae({type:"UPDATE_TOAST",toast:{...l,id:s}}),r=()=>Ae({type:"DISMISS_TOAST",toastId:s});return Ae({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:l=>{l||r()}}}),{id:s,dismiss:r,update:a}}function Ds(){const[t,s]=c.useState(ze);return c.useEffect(()=>(He.push(s),()=>{const a=He.indexOf(s);a>-1&&He.splice(a,1)}),[t]),{...t,toast:Ba,dismiss:a=>Ae({type:"DISMISS_TOAST",toastId:a})}}function S(...t){return Ut(Vt(t))}const Ja=Ht,Dt=c.forwardRef(({className:t,...s},a)=>e.jsx(Ks,{ref:a,className:S("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...s}));Dt.displayName=Ks.displayName;const Ya=Ve("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Et=c.forwardRef(({className:t,variant:s,...a},r)=>e.jsx(Ws,{ref:r,className:S(Ya({variant:s}),t),...a}));Et.displayName=Ws.displayName;const Ka=c.forwardRef(({className:t,...s},a)=>e.jsx(Zs,{ref:a,className:S("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...s}));Ka.displayName=Zs.displayName;const _t=c.forwardRef(({className:t,...s},a)=>e.jsx(Ys,{ref:a,className:S("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(bs,{className:"h-4 w-4"})}));_t.displayName=Ys.displayName;const Rt=c.forwardRef(({className:t,...s},a)=>e.jsx(Bs,{ref:a,className:S("text-sm font-semibold",t),...s}));Rt.displayName=Bs.displayName;const $t=c.forwardRef(({className:t,...s},a)=>e.jsx(Js,{ref:a,className:S("text-sm opacity-90",t),...s}));$t.displayName=Js.displayName;function Za(){const{toasts:t}=Ds();return e.jsxs(Ja,{children:[t.map(function({id:s,title:a,description:r,action:l,...i}){return e.jsxs(Et,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(Rt,{children:a}),r&&e.jsx($t,{children:r})]}),l,e.jsx(_t,{})]},s)}),e.jsx(Dt,{})]})}const Xa=({...t})=>{const s=typeof document<"u"&&document.documentElement.getAttribute("data-theme")||"light";return e.jsx(zt,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Qa=Wt,er=c.forwardRef(({className:t,sideOffset:s=4,...a},r)=>e.jsx(Xs,{ref:r,sideOffset:s,className:S("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));er.displayName=Xs.displayName;const Pt=({children:t})=>e.jsxs("div",{style:{minHeight:"100vh",width:"100%",background:"var(--bg)",position:"relative",overflow:"hidden"},children:[e.jsxs("div",{style:{position:"absolute",inset:0,zIndex:-10},children:[e.jsx("div",{style:{position:"absolute",top:"-20%",left:"-12%",width:520,height:520,background:"var(--primary)",borderRadius:"50%",filter:"blur(160px)",opacity:.12,animation:"pulse 7s infinite"}}),e.jsx("div",{style:{position:"absolute",bottom:"-15%",right:"-12%",width:620,height:620,background:"var(--accent)",borderRadius:"50%",filter:"blur(180px)",opacity:.06,animation:"pulse 9s infinite"}}),e.jsx("div",{style:{position:"absolute",top:"30%",right:"6%",width:420,height:420,background:"rgba(10,15,43,0.6)",borderRadius:"50%",filter:"blur(120px)",opacity:.6}})]}),e.jsx("div",{style:{display:"flex",minHeight:"100vh"},children:t})]}),sr=()=>e.jsx(Pt,{children:e.jsx("main",{className:"flex-1 p-8",children:e.jsxs("div",{className:"max-w-full mx-auto",children:[e.jsxs("div",{className:"glass-card p-4 mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Swagger UI"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Интерактивная документация API. Источник: ",e.jsx("code",{className:"font-mono",children:"/openapi.yaml"}),"."]})]}),e.jsx("div",{className:"h-[80vh] bg-transparent rounded overflow-hidden border",children:e.jsx("iframe",{src:"/swagger/index.html",title:"Swagger UI",className:"w-full h-full border-0"})})]})})});function tr(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Функции"}),e.jsx("p",{className:"text-muted-foreground mb-2",children:"Здесь список ключевых функций приложения и примеры использования."}),e.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[e.jsx("li",{children:"Трекинг привычек и статистика прогресса"}),e.jsx("li",{children:"Челленджи и streaks"}),e.jsx("li",{children:"Геймификация и мотивационные механики"})]})]})})}function ar(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Roadmap"}),e.jsx("p",{className:"text-muted-foreground mb-2",children:"Планы и этапы развития проекта."}),e.jsxs("ol",{className:"list-decimal pl-6 space-y-2 text-sm text-muted-foreground",children:[e.jsx("li",{children:"Версия 1.0 — основные возможности трекинга и профили."}),e.jsx("li",{children:"Версия 1.1 — социальные функции и челленджи."}),e.jsx("li",{children:"Версия 2.0 — расширенная аналитика и интеграции."})]})]})})}const Pe=()=>{const[t,s]=c.useState([]);c.useEffect(()=>{(()=>{const l=[];for(let i=0;i<50;i++)l.push({id:i,x:Math.random()*100,y:Math.random()*100,size:Math.random()*4+1,delay:Math.random()*5,duration:Math.random()*4+4,color:["gold","turquoise","purple"][Math.floor(Math.random()*3)]});s(l)})()},[]);const a=r=>{switch(r){case"gold":return"bg-gold";case"turquoise":return"bg-turquoise";case"purple":return"bg-purple-light"}};return e.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden z-0",children:[t.map(r=>e.jsx("div",{className:`absolute rounded-full ${a(r.color)} opacity-40 animate-float`,style:{left:`${r.x}%`,top:`${r.y}%`,width:`${r.size}px`,height:`${r.size}px`,animationDelay:`${r.delay}s`,animationDuration:`${r.duration}s`,boxShadow:`0 0 ${r.size*3}px currentColor`}},r.id)),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-purple-deep/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-turquoise/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 right-1/3 w-64 h-64 bg-gold/10 rounded-full blur-3xl"})]})},xe=({className:t="",glowColor:s="crystal"})=>{const a={gold:"text-gold drop-shadow-[0_0_10px_hsl(45,100%,60%,0.8)]",turquoise:"text-turquoise drop-shadow-[0_0_10px_hsl(174,100%,50%,0.8)]",purple:"text-purple-light drop-shadow-[0_0_10px_hsl(270,60%,60%,0.8)]",crystal:"text-crystal drop-shadow-[0_0_10px_hsl(220,80%,70%,0.8)]"};return e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",className:`${t} ${a[s]}`,children:[e.jsx("path",{d:"M12 2L4 8L12 22L20 8L12 2Z",fill:"currentColor",fillOpacity:"0.3"}),e.jsx("path",{d:"M12 2L4 8L12 14L20 8L12 2Z",fill:"currentColor",fillOpacity:"0.5"}),e.jsx("path",{d:"M12 2L4 8L12 22L20 8L12 2Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12 2V22",stroke:"currentColor",strokeWidth:"1",strokeOpacity:"0.5"}),e.jsx("path",{d:"M4 8L20 8",stroke:"currentColor",strokeWidth:"1",strokeOpacity:"0.5"})]})},rr=()=>e.jsxs("div",{className:"min-h-screen bg-background text-foreground overflow-x-hidden",children:[e.jsx(Pe,{}),e.jsxs("div",{className:"container mx-auto px-4 py-12 relative z-10",children:[e.jsxs(U,{to:"/",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-8",children:[e.jsx(Bt,{className:"w-4 h-4"}),"Вернуться на главную"]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center space-y-6 mb-12",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(xe,{className:"w-20 h-20",glowColor:"gold"})}),e.jsxs("h1",{className:"text-4xl md:text-5xl font-display font-bold text-foreground",children:["Инвестиции в ",e.jsx("span",{className:"text-gradient-magic",children:"Motify"})]}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Спасибо за интерес к проекту! Мы работаем над запуском инвестиционной кампании."})]}),e.jsxs("div",{className:"glass-card p-8 md:p-12 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-display font-bold text-foreground",children:"О проекте"}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:"Motify — это инновационное приложение для трекинга привычек и целей, которое превращает саморазвитие в увлекательное приключение. Мы создаем продукт, который помогает людям системно развиваться через геймификацию и персонализацию."})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 py-6",children:[e.jsxs("div",{className:"text-center p-6 glass-card",children:[e.jsx("div",{className:"text-3xl font-bold text-gold mb-2",children:"$50K"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Цель раунда (демо)"})]}),e.jsxs("div",{className:"text-center p-6 glass-card",children:[e.jsx("div",{className:"text-3xl font-bold text-turquoise mb-2",children:"Q1 2026"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Запуск (план)"})]}),e.jsxs("div",{className:"text-center p-6 glass-card",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-light mb-2",children:"100K+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Оценка пользователей (цель)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-display font-bold text-foreground",children:"Контакты"}),e.jsx("p",{className:"text-muted-foreground",children:"Для получения дополнительной информации об инвестиционных возможностях, пожалуйста, свяжитесь со мной напрямую:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:"mailto:ryazhskikh.dima.76@mail.ru",className:"flex items-center gap-3 text-muted-foreground hover:text-foreground transition-colors p-3 glass-card",children:[e.jsx(ke,{className:"w-5 h-5 text-gold"}),e.jsx("span",{children:"ryazhskikh.dima.76@mail.ru"})]}),e.jsxs("a",{href:"https://t.me/dimka_ryaz",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 text-muted-foreground hover:text-foreground transition-colors p-3 glass-card",children:[e.jsx("svg",{className:"w-5 h-5 text-turquoise",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M22 2L2 11.5L7 15L10 13L20 22L22 2Z"})}),e.jsx("span",{children:"Telegram: @dimka_ryaz"})]}),e.jsxs("a",{href:"https://github.com/Leg15Coder",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 text-muted-foreground hover:text-foreground transition-colors p-3 glass-card",children:[e.jsx(Qs,{className:"w-5 h-5 text-purple-light"}),e.jsx("span",{children:"GitHub"})]})]})]}),e.jsx("div",{className:"pt-6 border-t border-border/30",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Этот проект находится в стадии разработки. Информация о реальных инвестиционных возможностях будет доступна после завершения MVP и проведения юридической подготовки."})})]})]})]})]});function lr(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"О нас"}),e.jsx("p",{className:"text-muted-foreground",children:"Информация о команде и миссии проекта."})]})})}function ir(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Блог"}),e.jsx("p",{className:"text-muted-foreground",children:"Записи и новости проекта."})]})})}function nr(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Контакты"}),e.jsx("p",{className:"text-muted-foreground",children:"Связаться с командой проекта можно по почте или через соцсети."})]})})}const cr=Ve("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),R=c.forwardRef(({className:t,variant:s,size:a,asChild:r=!1,...l},i)=>{const m=r?et:"button";return e.jsx(m,{className:S(cr({variant:s,size:a,className:t})),ref:i,...l})});R.displayName="Button";const or=()=>{const t=Ns(),s=ie(),[a,r]=c.useState([]);return c.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname);const l=Array.from({length:30},(i,m)=>({id:m,x:Math.random()*100,y:Math.random()*100,delay:Math.random()*3}));r(l)},[t.pathname]),e.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsxs("div",{className:"relative w-[500px] h-[500px]",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-purple-500/20 via-pink-500/20 to-cyan-500/20 blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-purple-500/30 animate-spin-slow",style:{animationDuration:"20s"}}),e.jsx("div",{className:"absolute inset-8 rounded-full border-4 border-pink-500/30 animate-spin-slow",style:{animationDuration:"15s",animationDirection:"reverse"}}),e.jsx("div",{className:"absolute inset-16 rounded-full border-4 border-cyan-500/30 animate-spin-slow",style:{animationDuration:"10s"}}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-purple-600/10 via-transparent to-cyan-600/10 animate-pulse-slow"}),e.jsx("div",{className:"portal-crack absolute inset-0 rounded-full bg-black/50 backdrop-blur-sm",style:{clipPath:"polygon(50% 0%, 60% 20%, 80% 30%, 90% 50%, 80% 70%, 60% 80%, 50% 100%, 40% 80%, 20% 70%, 10% 50%, 20% 30%, 40% 20%)",animation:"crackExpand 3s ease-out infinite"}})]})}),a.map(l=>e.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-gradient-to-r from-purple-400 to-cyan-400 animate-float",style:{left:`${l.x}%`,top:`${l.y}%`,animationDelay:`${l.delay}s`,boxShadow:"0 0 10px rgba(168, 85, 247, 0.8)"}},l.id)),e.jsx("div",{className:"absolute top-20 left-20 w-32 h-32 rounded-full bg-purple-500/10 blur-2xl animate-float",style:{animationDelay:"0s",animationDuration:"4s"}}),e.jsx("div",{className:"absolute bottom-20 right-20 w-40 h-40 rounded-full bg-cyan-500/10 blur-2xl animate-float",style:{animationDelay:"1s",animationDuration:"5s"}}),e.jsx("div",{className:"absolute top-1/3 right-1/4 w-24 h-24 rounded-full bg-pink-500/10 blur-2xl animate-float",style:{animationDelay:"2s",animationDuration:"6s"}})]}),e.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto px-6 text-center space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"inline-block",children:[e.jsx("h1",{className:"text-9xl font-black bg-gradient-to-r from-purple-400 via-pink-400 to-cyan-400 bg-clip-text text-transparent animate-pulse-glow",children:"404"}),e.jsx("div",{className:"h-1 w-full bg-gradient-to-r from-purple-500 via-pink-500 to-cyan-500 animate-shimmer"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-white flex items-center justify-center gap-2",children:e.jsx(le,{className:"w-6 h-6 text-cyan-400 animate-spin-slow"})}),e.jsx("p",{className:"text-xl text-purple-200/80",children:"Путь, который вы ищете, рассыпался в пустоту..."})]})]}),e.jsxs("div",{className:"relative p-6 rounded-2xl bg-black/30 backdrop-blur-md border border-purple-500/30 shadow-2xl",children:[e.jsx("div",{className:"absolute -top-3 -right-3 w-6 h-6 rounded-full bg-pink-500 animate-ping"}),e.jsx("div",{className:"absolute -bottom-3 -left-3 w-6 h-6 rounded-full bg-cyan-500 animate-ping",style:{animationDelay:"1s"}}),e.jsxs("p",{className:"text-gray-300 mb-6",children:["Страница ",e.jsx("span",{className:"font-mono text-pink-400",children:t.pathname})," не существует в этой реальности. Возможно, она была поглощена магическим вихрем или никогда не создавалась."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs(R,{onClick:()=>s("/"),className:"group relative overflow-hidden bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white shadow-lg shadow-purple-500/50 transition-all duration-300",children:[e.jsx("span",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-cyan-400 to-purple-400 opacity-0 group-hover:opacity-20 transition-opacity duration-300"}),e.jsx(Jt,{className:"mr-2 h-4 w-4"}),"Вернуться на Главную"]}),e.jsxs(R,{onClick:()=>s(-1),variant:"outline",className:"border-purple-500/50 text-purple-300 hover:bg-purple-500/10 hover:border-purple-400 transition-all duration-300",children:[e.jsx(Yt,{className:"mr-2 h-4 w-4"}),"Назад"]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500 animate-pulse"}),e.jsx("span",{children:"Ошибка: страница не найдена"}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-500 animate-pulse",style:{animationDelay:"0.5s"}})]})]}),e.jsx("style",{children:`
        @keyframes spin-slow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @keyframes pulse-slow {
          0%, 100% { opacity: 0.3; }
          50% { opacity: 0.6; }
        }

        @keyframes float {
          0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
          10% { opacity: 1; }
          90% { opacity: 1; }
          100% { transform: translateY(-100vh) translateX(50px); opacity: 0; }
        }

        @keyframes pulse-glow {
          0%, 100% { 
            filter: drop-shadow(0 0 20px rgba(168, 85, 247, 0.8));
          }
          50% { 
            filter: drop-shadow(0 0 40px rgba(236, 72, 153, 1)) drop-shadow(0 0 60px rgba(6, 182, 212, 0.8));
          }
        }

        @keyframes crackExpand {
          0% {
            transform: scale(0);
            opacity: 0;
          }
          50% {
            opacity: 1;
          }
          100% {
            transform: scale(2);
            opacity: 0;
          }
        }

        @keyframes shimmer {
          0% {
            background-position: -100% 0;
          }
          100% {
            background-position: 200% 0;
          }
        }

        .animate-spin-slow {
          animation: spin-slow 3s linear infinite;
        }

        .animate-pulse-slow {
          animation: pulse-slow 4s ease-in-out infinite;
        }

        .animate-float {
          animation: float 6s ease-in-out infinite;
        }

        .animate-pulse-glow {
          animation: pulse-glow 3s ease-in-out infinite;
        }

        .animate-shimmer {
          background-size: 200% 100%;
          animation: shimmer 2s linear infinite;
        }

        .portal-crack {
          animation: crackExpand 3s ease-out infinite;
        }
      `})]})},G=c.forwardRef(({className:t,type:s,...a},r)=>e.jsx("input",{type:s,className:S("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...a}));G.displayName="Input";const we=c.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));we.displayName="Card";const Le=c.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("flex flex-col space-y-1.5 p-6",t),...s}));Le.displayName="CardHeader";const Ie=c.forwardRef(({className:t,...s},a)=>e.jsx("h3",{ref:a,className:S("text-2xl font-semibold leading-none tracking-tight",t),...s}));Ie.displayName="CardTitle";const Me=c.forwardRef(({className:t,...s},a)=>e.jsx("p",{ref:a,className:S("text-sm text-muted-foreground",t),...s}));Me.displayName="CardDescription";const Ce=c.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("p-6 pt-0",t),...s}));Ce.displayName="CardContent";const Es=c.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("flex items-center p-6 pt-0",t),...s}));Es.displayName="CardFooter";const dr=Ve("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Lt=c.forwardRef(({className:t,...s},a)=>e.jsx(st,{ref:a,className:S(dr(),t),...s}));Lt.displayName=st.displayName;const _s=Kt,It=c.createContext({}),re=({...t})=>e.jsx(It.Provider,{value:{name:t.name},children:e.jsx(Zt,{...t})}),es=()=>{const t=c.useContext(It),s=c.useContext(Mt),{getFieldState:a,formState:r}=Xt(),l=a(t.name,r);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:i}=s;return{id:i,name:t.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...l}},Mt=c.createContext({}),Q=c.forwardRef(({className:t,...s},a)=>{const r=c.useId();return e.jsx(Mt.Provider,{value:{id:r},children:e.jsx("div",{ref:a,className:S("space-y-2",t),...s})})});Q.displayName="FormItem";const ee=c.forwardRef(({className:t,...s},a)=>{const{error:r,formItemId:l}=es();return e.jsx(Lt,{ref:a,className:S(r&&"text-destructive",t),htmlFor:l,...s})});ee.displayName="FormLabel";const se=c.forwardRef(({...t},s)=>{const{error:a,formItemId:r,formDescriptionId:l,formMessageId:i}=es();return e.jsx(et,{ref:s,id:r,"aria-describedby":a?`${l} ${i}`:`${l}`,"aria-invalid":!!a,...t})});se.displayName="FormControl";const xr=c.forwardRef(({className:t,...s},a)=>{const{formDescriptionId:r}=es();return e.jsx("p",{ref:a,id:r,className:S("text-sm text-muted-foreground",t),...s})});xr.displayName="FormDescription";const te=c.forwardRef(({className:t,children:s,...a},r)=>{const{error:l,formMessageId:i}=es(),m=l?String(l?.message):s;return m?e.jsx("p",{ref:r,id:i,className:S("text-sm font-medium text-destructive",t),...a,children:m}):null});te.displayName="FormMessage";function We(t){if(!t||typeof t!="object")return"Произошла неизвестная ошибка";const s=t;switch(console.error("[Firebase Auth Error]",{code:s.code,message:s.message,error:t}),s.code){case"auth/email-not-verified":return"Email не подтвержден. Проверьте вашу почту и перейдите по ссылке из письма";case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":case"auth/invalid-login-credentials":return"Неверный email или пароль";case"auth/invalid-email":return"Неверный формат email адреса";case"auth/user-disabled":return"Этот аккаунт был заблокирован";case"auth/too-many-requests":return"Слишком много попыток входа. Попробуйте позже";case"auth/popup-closed-by-user":return"Вход прерван пользователем";case"auth/popup-blocked":return"Всплывающее окно было заблокировано браузером";case"auth/cancelled-popup-request":return"Запрос на вход был отменён";case"auth/unauthorized-domain":return"Домен не авторизован для входа через Google";case"auth/operation-not-allowed":return"Метод входа не разрешён. Обратитесь к администратору";case"auth/email-already-in-use":return"Email уже используется другим аккаунтом";case"auth/weak-password":return"Пароль слишком слабый. Используйте минимум 6 символов";case"auth/network-request-failed":return"Ошибка сети. Проверьте подключение к интернету";case"auth/expired-action-code":return"Ссылка устарела";case"auth/invalid-action-code":return"Недействительная ссылка";default:return s.message||"Произошла ошибка при входе. Попробуйте позже"}}function mr(t,s){const a=new Date().toISOString();if(!t)return{type:"unknown",userMessage:"Произошла неизвестная ошибка",originalError:t,timestamp:a};if(typeof t=="object"){const r=t;if(r.code&&r.code.startsWith("auth/"))return console.error(`[Error Handler - Firebase] ${s||"Unknown context"}:`,{code:r.code,message:r.message,timestamp:a}),{type:"firebase",userMessage:We(t),originalError:t,code:r.code,timestamp:a};if(r.status||r.statusCode){const l=r.status||r.statusCode;console.error(`[Error Handler - HTTP] ${s||"Unknown context"}:`,{status:l,message:r.message,timestamp:a});let i="Произошла ошибка при обращении к серверу";switch(l){case 400:i="Некорректный запрос";break;case 401:i="Необходима авторизация";break;case 403:i="Доступ запрещён";break;case 404:i="Данные не найдены";break;case 429:i="Слишком много запросов. Попробуйте позже";break;case 500:case 502:case 503:i="Ошибка сервера. Попробуйте позже";break}return{type:"http",userMessage:i,originalError:t,code:`HTTP_${l}`,timestamp:a}}if(r.message&&(r.message.includes("network")||r.message.includes("Failed to fetch")))return console.error(`[Error Handler - Network] ${s||"Unknown context"}:`,{message:r.message,timestamp:a}),{type:"network",userMessage:"Ошибка сети. Проверьте подключение к интернету",originalError:t,timestamp:a}}return console.error(`[Error Handler - Unknown] ${s||"Unknown context"}:`,{error:t,timestamp:a}),{type:"unknown",userMessage:typeof t=="string"?t:"Произошла ошибка. Попробуйте позже",originalError:t,timestamp:a}}function hr(t,s){const a={type:t.type,message:t.userMessage,code:t.code,timestamp:t.timestamp,context:s||"Unknown",originalError:t.originalError};if(t.type==="unknown"||t.type==="http"&&t.code?.includes("500")?console.error("[Critical Error]",a):console.warn("[Error]",a),typeof globalThis.window<"u"){const r=globalThis.window;r.Sentry&&r.Sentry.captureException(t.originalError,{tags:{errorType:t.type,context:s||"Unknown"},extra:{userMessage:t.userMessage,code:t.code}})}}function ur(t,s){const a=mr(t,s);return hr(a,s),a.userMessage}function me(t,s){const a=ur(t,s?.context);d.error(a,{duration:s?.duration??5e3,className:"glass-panel border-red-500/50",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"rgba(239, 68, 68, 0.5)",color:"white",minWidth:"360px",fontSize:"15px",padding:"16px 20px"}})}function Ge(t,s){d.success(t,{duration:4e3,className:"glass-panel border-green-500/50",style:{background:"rgba(34, 197, 94, 0.1)",borderColor:"rgba(34, 197, 94, 0.5)",color:"white",minWidth:"360px",fontSize:"15px",padding:"16px 20px"}})}const pr=ys({email:Ne().email("Неверный email адрес"),password:Ne().min(6,"Пароль должен содержать минимум 6 символов")});function gr(){const[t,s]=c.useState(!1),a=ie(),r=X(),l=ws({resolver:vs(pr),defaultValues:{email:"",password:""}});c.useEffect(()=>{(async()=>{try{s(!0);const n=await Y.checkGoogleRedirectResult();n&&(r(Be({id:n.uid,email:n.email,name:n.displayName,photoURL:n.photoURL})),Ge("Вход через Google выполнен"),a("/dashboard"))}catch(n){console.error("Redirect result error:",n),me(n,{context:"Google Login Redirect"})}finally{s(!1)}})()},[a,r]);const i=async o=>{s(!0);try{const n=await Y.login(o.email,o.password);r(Be({id:n.uid,email:n.email,name:n.displayName,photoURL:n.photoURL})),Ge("Вход выполнен успешно"),a("/dashboard")}catch(n){console.error("[Login Error]",{error:n,message:n instanceof Error?n.message:String(n),timestamp:new Date().toISOString(),email:o.email}),me(n,{context:"Login"})}finally{s(!1)}},m=async()=>{s(!0);try{await Y.googleLogin()}catch(o){if(o instanceof Error&&o.message==="REDIRECT_IN_PROGRESS")return;console.error("[Google Login Error]",{error:o,message:o instanceof Error?o.message:String(o),timestamp:new Date().toISOString()}),me(o,{context:"Google Login"}),s(!1)}};return e.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-background text-foreground px-4",children:[e.jsx(Pe,{}),e.jsxs(we,{className:"w-full max-w-md relative z-10",children:[e.jsxs(Le,{children:[e.jsx(Ie,{className:"text-2xl font-bold text-center",children:"Добро пожаловать"}),e.jsx(Me,{className:"text-center",children:"Введите данные для входа в аккаунт"})]}),e.jsx(Ce,{children:e.jsx(_s,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(i),className:"space-y-4",children:[e.jsx(re,{control:l.control,name:"email",render:({field:o})=>e.jsxs(Q,{children:[e.jsx(ee,{children:"Email"}),e.jsx(se,{children:e.jsx(G,{type:"email",placeholder:"m@example.com",...o})}),e.jsx(te,{})]})}),e.jsx(re,{control:l.control,name:"password",render:({field:o})=>e.jsxs(Q,{children:[e.jsx(ee,{children:"Пароль"}),e.jsx(se,{children:e.jsx(G,{type:"password",placeholder:"••••••",...o})}),e.jsx(te,{})]})}),e.jsx(R,{type:"submit","data-testid":"login-submit-btn",className:"w-full",disabled:t,children:t?"Вход...":"Войти"}),e.jsxs("div",{className:"relative my-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Или продолжить с"})})]}),e.jsxs(R,{variant:"outline",type:"button",className:"w-full",onClick:m,disabled:t,children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"})}),"Продолжить с Google"]})]})})}),e.jsx(Es,{className:"flex justify-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Нет аккаунта?"," ",e.jsx(U,{to:"/signup",className:"text-primary hover:underline",children:"Зарегистрироваться"})]})})]})]})}const fr=ys({name:Ne().min(2,"Имя должно содержать минимум 2 символа"),email:Ne().email("Неверный email адрес"),password:Ne().min(6,"Пароль должен содержать минимум 6 символов"),confirmPassword:Ne()}).refine(t=>t.password===t.confirmPassword,{message:"Пароли не совпадают",path:["confirmPassword"]});function jr(){const[t,s]=c.useState(!1),a=ie(),r=X(),l=ws({resolver:vs(fr),defaultValues:{name:"",email:"",password:"",confirmPassword:""}});c.useEffect(()=>{(async()=>{try{s(!0);const n=await Y.checkGoogleRedirectResult();n&&(r(Be({id:n.uid,email:n.email,name:n.displayName,photoURL:n.photoURL})),d.success("Регистрация через Google выполнена"),a("/dashboard"))}catch(n){console.error("Redirect result error:",n),d.error(We(n))}finally{s(!1)}})()},[a,r]);const i=async o=>{s(!0);try{const n=await Y.register(o.email,o.password,o.name);r(Be({id:n.uid,email:n.email,name:n.displayName,photoURL:n.photoURL})),d.success("Аккаунт создан! Проверьте вашу почту для подтверждения email."),a("/verify-email")}catch(n){d.error(We(n))}finally{s(!1)}},m=async()=>{s(!0);try{await Y.googleLogin()}catch(o){if(o instanceof Error&&o.message==="REDIRECT_IN_PROGRESS")return;d.error(We(o)),s(!1)}};return e.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-background text-foreground px-4",children:[e.jsx(Pe,{}),e.jsxs(we,{className:"w-full max-w-md relative z-10",children:[e.jsxs(Le,{children:[e.jsx(Ie,{className:"text-2xl font-bold text-center",children:"Создать аккаунт"}),e.jsx(Me,{className:"text-center",children:"Введите данные чтобы начать"})]}),e.jsx(Ce,{children:e.jsx(_s,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(i),className:"space-y-4",children:[e.jsx(re,{control:l.control,name:"name",render:({field:o})=>e.jsxs(Q,{children:[e.jsx(ee,{children:"Имя"}),e.jsx(se,{children:e.jsx(G,{placeholder:"Иван Иванов",...o})}),e.jsx(te,{})]})}),e.jsx(re,{control:l.control,name:"email",render:({field:o})=>e.jsxs(Q,{children:[e.jsx(ee,{children:"Email"}),e.jsx(se,{children:e.jsx(G,{type:"email",placeholder:"m@example.com",...o})}),e.jsx(te,{})]})}),e.jsx(re,{control:l.control,name:"password",render:({field:o})=>e.jsxs(Q,{children:[e.jsx(ee,{children:"Пароль"}),e.jsx(se,{children:e.jsx(G,{type:"password",placeholder:"••••••",...o})}),e.jsx(te,{})]})}),e.jsx(re,{control:l.control,name:"confirmPassword",render:({field:o})=>e.jsxs(Q,{children:[e.jsx(ee,{children:"Подтвердите пароль"}),e.jsx(se,{children:e.jsx(G,{type:"password",placeholder:"••••••",...o})}),e.jsx(te,{})]})}),e.jsx(R,{type:"submit","data-testid":"signup-submit-btn",className:"w-full",disabled:t,children:t?"Создание аккаунта...":"Зарегистрироваться"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Или"})})]}),e.jsxs(R,{variant:"outline",type:"button",className:"w-full",onClick:m,disabled:t,children:[e.jsx("svg",{className:"mr-2 h-4 w-4","aria-hidden":"true",focusable:"false","data-prefix":"fab","data-icon":"google",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 488 512",children:e.jsx("path",{fill:"currentColor",d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"})}),"Продолжить с Google"]})]})})}),e.jsx(Es,{className:"flex justify-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Уже есть аккаунт?"," ",e.jsx(U,{to:"/login",className:"text-primary hover:underline",children:"Войти"})]})})]})]})}const br=Ve("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ss=c.forwardRef(({className:t,variant:s,...a},r)=>e.jsx("div",{ref:r,role:"alert",className:S(br({variant:s}),t),...a}));ss.displayName="Alert";const Ft=c.forwardRef(({className:t,...s},a)=>e.jsx("h5",{ref:a,className:S("mb-1 font-medium leading-none tracking-tight",t),...s}));Ft.displayName="AlertTitle";const ts=c.forwardRef(({className:t,...s},a)=>e.jsx("div",{ref:a,className:S("text-sm [&_p]:leading-relaxed",t),...s}));ts.displayName="AlertDescription";function Nr(){const[t,s]=c.useState(!1),[a,r]=c.useState(!1),[l,i]=c.useState(!0),[m,o]=c.useState(0),n=ie();c.useEffect(()=>{(async()=>{try{await Y.checkEmailVerified()&&n("/dashboard")}catch(k){console.error("Error checking verification:",k)}})()},[n]),c.useEffect(()=>{if(m>0){const N=setTimeout(()=>o(m-1),1e3);return()=>clearTimeout(N)}else i(!0)},[m]);const x=async()=>{r(!0);try{await Y.sendVerificationEmail(),d.success("Письмо отправлено повторно. Проверьте вашу почту."),i(!1),o(60)}catch(N){const k=N instanceof Error?N.message:"Не удалось отправить письмо";d.error(k)}finally{r(!1)}},h=async()=>{s(!0);try{await Y.checkEmailVerified()?(d.success("Email успешно подтвержден!"),n("/dashboard")):d.info("Email еще не подтвержден. Проверьте почту и перейдите по ссылке из письма.")}catch(N){const k=N instanceof Error?N.message:"Ошибка проверки";d.error(k)}finally{s(!1)}},f=()=>{n("/dashboard")};return e.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-background text-foreground px-4",children:[e.jsx(Pe,{}),e.jsxs(we,{className:"w-full max-w-md relative z-10",children:[e.jsxs(Le,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:e.jsx(ke,{className:"h-8 w-8 text-blue-600"})})}),e.jsx(Ie,{className:"text-2xl font-bold text-center",children:"Подтвердите ваш email"}),e.jsx(Me,{className:"text-center",children:"Мы отправили письмо с ссылкой для подтверждения на вашу почту"})]}),e.jsxs(Ce,{className:"space-y-4",children:[e.jsxs(ss,{children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx(ts,{children:'Проверьте папку "Спам" если не видите письмо во входящих'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(R,{onClick:h,className:"w-full",disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Проверка..."]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Я подтвердил email"]})}),e.jsx(R,{variant:"outline",onClick:x,className:"w-full",disabled:a||!l,children:a?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Отправка..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),m>0?`Отправить повторно (${m}с)`:"Отправить письмо повторно"]})}),e.jsx(R,{variant:"ghost",onClick:f,className:"w-full",children:"Пропустить (можно подтвердить позже)"})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Не получили письмо?"}),e.jsx("p",{className:"mt-1",children:"Проверьте правильность адреса email или попробуйте отправить письмо повторно"})]})]})]})]})}function wr(){const[t]=ks(),[s,a]=c.useState("loading"),[r,l]=c.useState(""),i=ie();c.useEffect(()=>{(async()=>{const n=t.get("oobCode");if(t.get("mode")!=="verifyEmail"||!n){a("error"),l("Неверная ссылка подтверждения");return}try{await Y.verifyEmailCode(n),a("success"),setTimeout(()=>{i("/dashboard")},3e3)}catch(h){a("error");const f=h instanceof Error?h.message:"Не удалось подтвердить email";l(f)}})()},[t,i]);const m=()=>{i(s==="success"?"/dashboard":"/verify-email")};return e.jsxs("div",{className:"relative flex items-center justify-center min-h-screen bg-background text-foreground px-4",children:[e.jsx(Pe,{}),e.jsxs(we,{className:"w-full max-w-md relative z-10",children:[e.jsxs(Le,{children:[e.jsxs("div",{className:"flex justify-center mb-4",children:[s==="loading"&&e.jsx("div",{className:"rounded-full bg-blue-100 p-3",children:e.jsx(Ee,{className:"h-8 w-8 text-blue-600 animate-spin"})}),s==="success"&&e.jsx("div",{className:"rounded-full bg-green-100 p-3",children:e.jsx($e,{className:"h-8 w-8 text-green-600"})}),s==="error"&&e.jsx("div",{className:"rounded-full bg-red-100 p-3",children:e.jsx(Qt,{className:"h-8 w-8 text-red-600"})})]}),e.jsxs(Ie,{className:"text-2xl font-bold text-center",children:[s==="loading"&&"Подтверждение email...",s==="success"&&"Email подтвержден!",s==="error"&&"Ошибка подтверждения"]}),e.jsxs(Me,{className:"text-center",children:[s==="loading"&&"Пожалуйста, подождите",s==="success"&&"Ваш email успешно подтвержден. Сейчас вы будете перенаправлены на главную страницу.",s==="error"&&r]})]}),s!=="loading"&&e.jsx(Ce,{children:e.jsx(R,{onClick:m,className:"w-full",children:s==="success"?"Перейти к приложению":"Запросить новое письмо"})})]})]})}const vr=()=>e.jsx(Pt,{children:e.jsx("main",{className:"flex-1 p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Полная документация API"}),e.jsx("p",{className:"text-muted-foreground",children:"Здесь собрана расширенная документация по REST API приложения: схемы ресурсов, примеры запросов/ответов и рекомендации по интеграции."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{to:"/openapi.yaml",className:"inline-block px-4 py-2 rounded bg-turquoise text-background",children:"Скачать OpenAPI (raw)"}),e.jsx(U,{to:"/public/swagger",className:"inline-block px-4 py-2 rounded bg-gold text-background",children:"Открыть Swagger (статический)"})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Общие сведения"}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:["Base URL: ",e.jsx("code",{className:"font-mono",children:"<VITE_API_BASE_URL>"}),"."]}),e.jsxs("p",{className:"mt-2 text-sm text-muted-foreground",children:["Аутентификация: JWT в заголовке ",e.jsx("code",{className:"font-mono",children:"Authorization: Bearer <token>"}),". Клиент автоматически добавляет токен из localStorage (ключ 'token')."]})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"/api/habits"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"GET /api/habits — получить список привычек."}),e.jsx("pre",{className:"mt-3 bg-[#0b1220] p-3 rounded text-[12px] overflow-x-auto",children:`Response 200
[
  {
    "id": "h1",
    "title": "Drink water",
    "description": "Drink 2L",
    "completed": false,
    "streak": 3,
    "createdAt": "2025-11-27T...Z",
    "updatedAt": null
  }
]`}),e.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"POST /api/habits — создать привычку."}),e.jsx("pre",{className:"mt-3 bg-[#0b1220] p-3 rounded text-[12px] overflow-x-auto",children:`Request
{ "title": "Read", "description": "30 min" }

Response 201
{ "id": "h123", "title": "Read", "description": "30 min", "completed": false, "streak": 0, "createdAt": "..." }`})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["/api/habits/","{id}"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["PATCH /api/habits/","{id}"," — частичное обновление."]}),e.jsx("pre",{className:"mt-3 bg-[#0b1220] p-3 rounded text-[12px] overflow-x-auto",children:`Request
{ "completed": true }

Response 200
{ "id": "h123", "title": "Read", "completed": true, ... }`}),e.jsxs("p",{className:"mt-3 text-sm text-muted-foreground",children:["DELETE /api/habits/","{id}"," — удалить привычку (204)."]})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["/api/habits/","{id}","/toggle"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"PATCH — переключить состояние completed (mock helper)."})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"/api/goals"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"GET /api/goals — список целей."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"POST /api/goals — создать цель."})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"/api/me"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"GET /api/me — профиль текущего пользователя."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"PATCH /api/me — обновить профиль (Partial<User>)."}),e.jsx("pre",{className:"mt-3 bg-[#0b1220] p-3 rounded text-[12px] overflow-x-auto",children:`Response 200
{ "id":"u1","name":"Demo User","email":"demo@example.com","avatar":null }
`})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"/api/challenges"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"GET /api/challenges — получить список вызовов."})]}),e.jsxs("section",{className:"glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Схемы и форматы"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Схемы описаны в OpenAPI (см. ",e.jsx("code",{className:"font-mono",children:"/openapi.yaml"}),")."]})]})]})})}),yr=()=>{const[t,s]=c.useState(!1),a=[{label:"О продукте",href:"#hero"},{label:"Функции",href:"#features"},{label:"Сценарии",href:"#scenarios"},{label:"API",href:"#api"}],r=l=>{l.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})};return e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50",children:e.jsx("div",{className:"mx-4 mt-4",children:e.jsxs("nav",{className:"container mx-auto glass-card px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:r,className:"flex items-center gap-3 group cursor-pointer bg-transparent border-none p-0","aria-label":"Перейти вверх",children:[e.jsx(xe,{className:"w-8 h-8 group-hover:scale-110 transition-transform",glowColor:"gold"}),e.jsx("span",{className:"font-display text-xl font-bold text-foreground",children:"Motify"})]}),e.jsx("div",{className:"hidden md:flex items-center gap-8",children:a.map(l=>e.jsxs("a",{href:l.href,className:"text-sm text-muted-foreground hover:text-foreground transition-colors relative group",children:[l.label,e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-gold transition-all group-hover:w-full"})]},l.href))}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{to:"/signup",className:"btn-outline-magic py-2 px-4 text-sm",children:"Регистрация"}),e.jsxs(U,{to:"/login",className:"btn-magic py-2 px-6 text-sm flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Войти"]})]})}),e.jsx("button",{className:"md:hidden p-2 text-foreground",onClick:()=>s(!t),children:t?e.jsx(bs,{className:"w-6 h-6"}):e.jsx(ea,{className:"w-6 h-6"})})]}),t&&e.jsxs("div",{className:"md:hidden mt-4 pt-4 border-t border-border/30 space-y-4",children:[a.map(l=>e.jsx("a",{href:l.href,className:"block text-muted-foreground hover:text-foreground transition-colors",onClick:()=>s(!1),children:l.label},l.href)),e.jsxs(U,{to:"/login",className:"btn-magic w-full py-2 text-sm flex items-center justify-center gap-2",onClick:()=>s(!1),children:[e.jsx(le,{className:"w-4 h-4"}),"Войти"]}),e.jsx(U,{to:"/signup",className:"btn-outline-magic w-full py-2 text-sm flex items-center justify-center gap-2",onClick:()=>s(!1),children:"Регистрация"})]})]})})})},kr=()=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/30 via-turquoise/20 to-gold/20 blur-3xl scale-110"}),e.jsxs("div",{className:"relative glass-card-strong p-6 space-y-4 magic-border animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border/30 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"w-8 h-8",glowColor:"gold"}),e.jsx("span",{className:"font-display text-xl text-foreground",children:"Motify"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 rounded-full bg-gold/20 text-gold text-sm",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsx("span",{children:"14 дней"})]}),e.jsx(tt,{className:"w-5 h-5 text-muted-foreground"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"glass-card p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gold",children:"7/10"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Привычек"})]}),e.jsxs("div",{className:"glass-card p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-turquoise",children:"3/5"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Целей"})]}),e.jsxs("div",{className:"glass-card p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-light",children:"2"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Вызова"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4 text-turquoise"}),"Привычки на сегодня"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(os,{title:"Медитация",progress:100,streak:14,completed:!0,color:"gold"}),e.jsx(os,{title:"Чтение 30 минут",progress:80,streak:7,color:"turquoise"}),e.jsx(os,{title:"Спорт",progress:50,streak:3,color:"purple"})]})]}),e.jsxs("div",{className:"glass-card p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-gold"}),e.jsx("span",{className:"font-semibold text-foreground",children:"Выучить TypeScript"})]}),e.jsx("span",{className:"text-sm text-gold",children:"68%"})]}),e.jsxs("div",{className:"relative h-2 bg-secondary rounded-full overflow-hidden",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 bg-gradient-gold rounded-full",style:{width:"68%"}}),e.jsx("div",{className:"absolute inset-0 animate-shimmer opacity-50"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(sa,{className:"w-3 h-3 text-turquoise"}),e.jsx("span",{children:"+12% за эту неделю"})]})]})]}),e.jsx("div",{className:"absolute -right-4 top-20 glass-card p-3 animate-float shadow-glow-turquoise",style:{animationDelay:"1s"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-turquoise/20 flex items-center justify-center",children:e.jsx(Cr,{className:"w-4 h-4 text-turquoise"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-foreground",children:"Новое достижение!"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"7 дней подряд"})]})]})}),e.jsx("div",{className:"absolute -left-4 bottom-32 glass-card p-3 animate-float shadow-glow-gold",style:{animationDelay:"2s"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-6 h-6 text-gold animate-pulse-glow"}),e.jsx("span",{className:"text-lg font-bold text-gold",children:"14"})]})})]}),Cr=({className:t})=>e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:t,stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 3v2M12 19v2M3 12h2M19 12h2M5.64 5.64l1.41 1.41M16.95 16.95l1.41 1.41M5.64 18.36l1.41-1.41M16.95 7.05l1.41-1.41"})}),os=({title:t,progress:s,streak:a,completed:r,color:l})=>{const i={gold:"text-gold bg-gold",turquoise:"text-turquoise bg-turquoise",purple:"text-purple-light bg-purple-light"};return e.jsxs("div",{className:`glass-card p-3 flex items-center justify-between ${r?"border-l-2 border-l-gold":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg ${i[l]}/20 flex items-center justify-center`,children:r?e.jsx($e,{className:`w-5 h-5 ${i[l].split(" ")[0]}`}):e.jsx("div",{className:`w-3 h-3 rounded-full ${i[l]}/50`})}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${r?"text-muted-foreground line-through":"text-foreground"}`,children:t}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(qe,{className:"w-3 h-3 text-gold"}),a," дней"]})]})]}),e.jsxs("div",{className:"w-12 h-12 relative",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"4",className:"text-secondary"}),e.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeDasharray:`${s*1.256} 125.6`,className:i[l].split(" ")[0],strokeLinecap:"round"})]}),e.jsxs("span",{className:`absolute inset-0 flex items-center justify-center text-xs font-bold ${i[l].split(" ")[0]}`,children:[s,"%"]})]})]})},Sr=()=>{const{toast:t}=Ds(),s=()=>{t({title:"В разработке",description:"Видео демонстрация скоро будет доступна"})};return e.jsxs("section",{className:"relative min-h-screen flex items-center justify-center px-4 pt-20 pb-16 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-purple-deep/30 via-transparent to-background z-0"}),e.jsx("div",{className:"absolute top-20 left-10 w-72 h-72 bg-primary/20 rounded-full blur-3xl animate-pulse-glow"}),e.jsx("div",{className:"absolute bottom-20 right-10 w-96 h-96 bg-turquoise/15 rounded-full blur-3xl"}),e.jsx("div",{className:"container mx-auto relative z-10",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-20 items-center",children:[e.jsxs("div",{className:"text-center lg:text-left space-y-8",children:[e.jsxs("output",{className:"inline-flex items-center gap-2 px-4 py-2 glass-card text-sm","aria-live":"polite",children:[e.jsx(le,{className:"w-4 h-4 text-gold"}),e.jsx("span",{className:"text-muted-foreground",children:"Превращаем рутину в приключение"})]}),e.jsxs("h1",{className:"section-title text-foreground leading-tight",children:["Прокачивай"," ",e.jsx("span",{className:"text-gradient-gold",children:"привычки"}),e.jsx("br",{}),"достигай"," ",e.jsx("span",{className:"text-gradient-magic",children:"целей"})]}),e.jsxs("p",{className:"text-lg md:text-xl text-muted-foreground leading-relaxed max-w-xl text-left",children:["Motify помогает системно развивать привычки и добиваться целей через"," ",e.jsx("span",{className:"text-turquoise",children:"трекинг"}),","," ",e.jsx("span",{className:"text-gold",children:"визуализацию прогресса"}),","," ","вызовы, челленджи и мягкие напоминания. Забудьте о скучных трекерах — окунитесь в геймифицированный опыт."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start",children:[e.jsx(U,{to:"/signup",className:"btn-outline-magic flex items-center justify-center gap-2","aria-label":"Sign up",children:"Регистрация"}),e.jsxs(U,{to:"/login",className:"btn-magic flex items-center justify-center gap-2 group","aria-label":"Try demo",children:[e.jsx(le,{className:"w-5 h-5"}),"Войти",e.jsx(Cs,{className:"w-4 h-4 transition-transform group-hover:translate-x-1"})]}),e.jsxs("button",{onClick:s,className:"btn-outline-magic flex items-center justify-center gap-2","aria-label":"Watch how it works",type:"button",children:[e.jsx(at,{className:"w-5 h-5"}),"Посмотреть демо"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-8 justify-center lg:justify-start pt-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-gold",children:"+87%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"продуктивности"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-turquoise",children:"10K+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"незабытых дел"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-light",children:"100%"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"интересно"})]})]})]}),e.jsx("div",{className:"relative",children:e.jsx(kr,{})})]})})]})},qs=({className:t="",variant:s=1})=>{const a={1:e.jsx("path",{d:"M12 2V22M8 6L16 18M16 6L8 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),2:e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"12",r:"8",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),e.jsx("path",{d:"M12 4V12L17 17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),e.jsx("path",{d:"M12 12L7 17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),3:e.jsxs(e.Fragment,{children:[e.jsx("polygon",{points:"12,2 22,12 12,22 2,12",fill:"none",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"currentColor",fillOpacity:"0.5",stroke:"currentColor",strokeWidth:"1"})]})};return e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:`${t} text-gold drop-shadow-[0_0_8px_hsl(45,100%,60%,0.6)]`,children:a[s]})},Tr=()=>{const t=[{icon:e.jsx(Ze,{className:"w-8 h-8"}),crystal:e.jsx(xe,{className:"w-12 h-12",glowColor:"gold"}),title:"Привычки не приживаются",description:"Люди бросают привычки через несколько дней. Нет визуального прогресса, нет ощущения достижения, мотивация угасает.",color:"gold"},{icon:e.jsx(Xe,{className:"w-8 h-8"}),crystal:e.jsx(xe,{className:"w-12 h-12",glowColor:"turquoise"}),title:"Цели остаются мечтами",description:"Цели расплывчатые и не разбиты на конкретные шаги. Без структуры и дедлайнов они так и остаются в списке желаний.",color:"turquoise"},{icon:e.jsx(Ss,{className:"w-8 h-8"}),crystal:e.jsx(xe,{className:"w-12 h-12",glowColor:"purple"}),title:"Скучные трекеры убивают мотивацию",description:"Существующие приложения сухие и функциональные. Нет эмоций, визуального кайфа, ощущения победы над собой.",color:"purple"}],s={gold:{iconBg:"bg-gold/20",iconText:"text-gold",border:"border-gold/30",glow:"shadow-glow-gold"},turquoise:{iconBg:"bg-turquoise/20",iconText:"text-turquoise",border:"border-turquoise/30",glow:"shadow-glow-turquoise"},purple:{iconBg:"bg-purple-light/20",iconText:"text-purple-light",border:"border-purple-light/30",glow:"shadow-glow-purple"}};return e.jsxs("section",{className:"relative py-24 px-4 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 left-10 opacity-20",children:e.jsx(qs,{className:"w-16 h-16",variant:1})}),e.jsx("div",{className:"absolute bottom-20 right-10 opacity-20",children:e.jsx(qs,{className:"w-20 h-20",variant:2})}),e.jsxs("div",{className:"container mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsxs("h2",{className:"section-title text-foreground",children:["Какую ",e.jsx("span",{className:"text-gradient-gold",children:"проблему"})," решаем"]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Понимаем боль. У нас есть решение."})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:t.map((a,r)=>e.jsxs("div",{className:`glass-card-strong p-8 space-y-6 group hover:${s[a.color].glow} transition-all duration-500 hover:-translate-y-2`,style:{animationDelay:`${r*.2}s`},children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:`relative p-4 rounded-2xl ${s[a.color].iconBg} ${s[a.color].border} border`,children:[a.crystal,e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-gold rounded-full animate-sparkle"})]})}),e.jsx("h3",{className:`text-xl font-display font-bold text-center ${s[a.color].iconText}`,children:a.title}),e.jsx("p",{className:"text-muted-foreground text-center leading-relaxed text-justify",children:a.description}),e.jsx("div",{className:`h-1 w-20 mx-auto rounded-full bg-gradient-to-r from-transparent via-${a.color} to-transparent opacity-50`})]},r))})]})]})},Dr=()=>{const t=[{icon:e.jsx(qe,{className:"w-6 h-6"}),title:"Трекер привычек со страйками",description:"Отслеживайте прогресс, не прерывайте серии, получайте награды за преодоления себя.",color:"gold",mockup:e.jsx(Er,{})},{icon:e.jsx(Xe,{className:"w-6 h-6"}),title:"Цели с подпунктами",description:"Разбивайте большие цели на шаги, устанавливайте дедлайны, видьте прогресс.",color:"turquoise",mockup:e.jsx(_r,{})},{icon:e.jsx(Qe,{className:"w-6 h-6"}),title:"Челленджи и достижения",description:"Присоединяйтесь к вызовам, соревнуйтесь с собой, собирайте награды.",color:"purple",mockup:e.jsx(Rr,{})},{icon:e.jsx(tt,{className:"w-6 h-6"}),title:"Волшебство игры",description:"Дружелюбные уведомления, которые мотивируют, а не раздражают.",color:"crystal",mockup:e.jsx($r,{})}],s=a=>{const r={gold:{bg:"bg-gold/20",text:"text-gold",glow:"shadow-glow-gold"},turquoise:{bg:"bg-turquoise/20",text:"text-turquoise",glow:"shadow-glow-turquoise"},purple:{bg:"bg-purple-light/20",text:"text-purple-light",glow:"shadow-glow-purple"},crystal:{bg:"bg-crystal/20",text:"text-crystal",glow:"shadow-glow-crystal"}};return r[a]||r.gold};return e.jsxs("section",{className:"relative py-24 px-4 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-purple-deep/20 to-transparent"}),e.jsxs("div",{className:"container mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 glass-card text-sm mb-4",children:[e.jsx(le,{className:"w-4 h-4 text-gold"}),e.jsx("span",{className:"text-muted-foreground",children:"Ключевой функционал"})]}),e.jsxs("h2",{className:"section-title text-foreground",children:["Решение, которое ",e.jsx("span",{className:"text-gradient-magic",children:"работает"})]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Каждая функция создана, чтобы превратить рутину в увлекательное приключение"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:t.map((a,r)=>{const l=s(a.color);return e.jsx("div",{className:"glass-card-strong p-6 group hover:-translate-y-1 transition-all duration-500",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx("div",{className:`inline-flex p-3 rounded-xl ${l.bg}`,children:e.jsx("div",{className:l.text,children:a.icon})}),e.jsx("h3",{className:"text-xl font-display font-bold text-foreground",children:a.title}),e.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.description})]}),e.jsx("div",{className:"hidden sm:block w-40 flex-shrink-0",children:a.mockup})]})},r)})})]})]})},Er=()=>e.jsxs("div",{className:"glass-card p-3 space-y-2 h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(qe,{className:"w-3 h-3 text-gold"}),e.jsx("span",{children:"Streak: 14"})]}),[70,100,45].map((t,s)=>e.jsx("div",{className:"space-y-1",children:e.jsx("div",{className:"h-1.5 bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-gold rounded-full",style:{width:`${t}%`}})})},s))]}),_r=()=>e.jsxs("div",{className:"glass-card p-3 space-y-2 h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-turquoise",children:[e.jsx(Xe,{className:"w-3 h-3"}),e.jsx("span",{children:"68%"})]}),e.jsx("div",{className:"space-y-1.5",children:["Основы","Функции","Типы"].map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s<2?"bg-turquoise":"bg-secondary"}`}),e.jsx("span",{className:s<2?"text-muted-foreground line-through":"text-foreground",children:t})]},s))})]}),Rr=()=>e.jsxs("div",{className:"glass-card p-3 space-y-2 h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-purple-light",children:[e.jsx(Qe,{className:"w-3 h-3"}),e.jsx("span",{children:"30 дней"})]}),e.jsx("div",{className:"grid grid-cols-5 gap-1",children:Array.from({length:15}).map((t,s)=>e.jsx("div",{className:`w-3 h-3 rounded-sm ${s<10?"bg-purple-light":"bg-secondary"}`},s))})]}),$r=()=>e.jsx("div",{className:"glass-card p-3 space-y-2 h-full",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gold/20 flex items-center justify-center",children:e.jsx(Ss,{className:"w-3 h-3 text-gold"})}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"text-foreground",children:"Время медитации!"}),e.jsx("div",{className:"text-muted-foreground",children:"Сейчас"})]})]})}),Pr=()=>{const t=[{title:"Новая привычка",color:"gold",steps:[{icon:e.jsx(ls,{className:"w-4 h-4"}),text:"Заходит на главную страницу"},{icon:e.jsx(is,{className:"w-4 h-4"}),text:'Нажимает "Добавить привычку"'},{icon:e.jsx(ps,{className:"w-4 h-4"}),text:"Заполняет форму"},{icon:e.jsx(le,{className:"w-4 h-4"}),text:"Видит карточку с квестами"}]},{title:"Работа с целью",color:"turquoise",steps:[{icon:e.jsx(ls,{className:"w-4 h-4"}),text:"Открывает список целей"},{icon:e.jsx(ps,{className:"w-4 h-4"}),text:"Выбирает цель, видит подпункты"},{icon:e.jsx(is,{className:"w-4 h-4"}),text:"Отмечает выполненный шаг"},{icon:e.jsx(le,{className:"w-4 h-4"}),text:"Видит свой рост"}]},{title:"Челленджи и мотивация",color:"purple",steps:[{icon:e.jsx(ls,{className:"w-4 h-4"}),text:"Открывает раздел вызовов"},{icon:e.jsx(Ss,{className:"w-4 h-4"}),text:"Фильтрует по категории"},{icon:e.jsx(is,{className:"w-4 h-4"}),text:"Присоединяется к челленджу"},{icon:e.jsx(le,{className:"w-4 h-4"}),text:"Работает над собой"}]}],s=a=>({gold:{bg:"bg-gold/20",text:"text-gold",border:"border-gold/40",gradient:"from-gold/20 to-transparent",line:"bg-gold/50"},turquoise:{bg:"bg-turquoise/20",text:"text-turquoise",border:"border-turquoise/40",gradient:"from-turquoise/20 to-transparent",line:"bg-turquoise/50"},purple:{bg:"bg-purple-light/20",text:"text-purple-light",border:"border-purple-light/40",gradient:"from-purple-light/20 to-transparent",line:"bg-purple-light/50"}})[a];return e.jsx("section",{className:"relative py-24 px-4 overflow-hidden",children:e.jsxs("div",{className:"container mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsxs("h2",{className:"section-title text-foreground",children:["Пользовательские ",e.jsx("span",{className:"text-gradient-gold",children:"сценарии"})]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Как пользователи взаимодействуют с Motify"})]}),e.jsx("div",{className:"grid lg:grid-cols-3 gap-8",children:t.map((a,r)=>{const l=s(a.color);return e.jsxs("div",{className:"glass-card-strong p-6 space-y-6 group hover:-translate-y-1 transition-all duration-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl ${l.bg} flex items-center justify-center`,children:e.jsx("span",{className:`font-display font-bold ${l.text}`,children:r+1})}),e.jsx("h3",{className:"text-xl font-display font-bold text-foreground",children:a.title})]}),e.jsxs("div",{className:"relative space-y-4 pl-6",children:[e.jsx("div",{className:`absolute left-2 top-2 bottom-2 w-0.5 ${l.line}`}),t[r].steps.map((i,m)=>e.jsxs("div",{className:"relative flex items-start gap-4",children:[e.jsx("div",{className:`absolute -left-4 w-4 h-4 rounded-full ${l.bg} ${l.border} border-2 flex items-center justify-center`,children:e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${l.text.replace("text-","bg-")}`})}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${l.bg}`,children:e.jsx("span",{className:l.text,children:i.icon})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:i.text})]}),m<a.steps.length-1&&e.jsx(Cs,{className:`w-4 h-4 ${l.text} opacity-30 absolute right-0 top-2`})]},m))]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full ${l.bg} ${l.border} border text-sm`,children:[e.jsx(le,{className:`w-4 h-4 ${l.text}`}),e.jsx("span",{className:l.text,children:"Виртуальная игра - реальный результат"})]})]},r)})})]})})},ds=({value:t,label:s,className:a=""})=>e.jsxs("div",{className:`${a} p-4 bg-white/5 rounded-lg text-center`,children:[e.jsx("div",{className:"text-2xl font-bold",children:t}),e.jsx("div",{className:"text-sm text-white/60",children:s})]}),Gs=({title:t,progress:s=0,description:a})=>{const r=Math.max(0,Math.min(100,Math.round(s)));return e.jsxs("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 flex flex-col gap-3 glass-panel",role:"group","aria-label":`Goal ${t}`,children:[e.jsx("div",{className:"flex items-start justify-between gap-3",children:e.jsx("p",{className:"goal-card-title text-white",children:t})}),e.jsx("div",{className:"w-full bg-black/20 rounded-full h-3 overflow-hidden mt-1","aria-hidden":!0,children:e.jsx("div",{className:"bg-primary h-3 rounded-full",style:{width:`${r}%`,boxShadow:"0 0 8px rgba(190, 52, 213, 0.7)"}})}),e.jsx("p",{className:"text-sm text-white-60 mt-1",children:a??`${r}% complete`}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-white/60",children:[e.jsxs("span",{"aria-hidden":!0,children:[r,"%"]}),e.jsx("button",{className:"px-3 py-1 rounded bg-white/6 hover:bg-white/10 text-sm",children:"Details"})]})]})},Lr=({title:t,days:s,description:a})=>e.jsxs("div",{className:"relative p-4 rounded-lg bg-gradient-to-br from-accent/10 to-primary/10 border border-accent/30 flex flex-col gap-3 items-center text-center glow-border challenge-card",children:[e.jsx("span",{className:"material-symbols-outlined text-accent text-4xl",children:"local_fire_department"}),e.jsx("p",{className:"text-white font-bold text-lg",children:t}),a&&e.jsx("p",{className:"text-white/70 text-sm",children:a}),s&&e.jsx("div",{className:"mt-2 text-2xl font-black text-accent tracking-widest",children:s})]}),Ir="_previewRoot_12m84_2",Mr="_glassPanelOverride_12m84_17",Fr="_statGrid_12m84_82",Or="_smallCard_12m84_87",ye={previewRoot:Ir,glassPanelOverride:Mr,statGrid:Fr,smallCard:Or},Ar=()=>e.jsxs("div",{className:`w-full h-full pointer-events-none flex flex-col gap-3 min-h-0 overflow-hidden ${ye.previewRoot}`,children:[e.jsxs("div",{className:"flex items-center justify-between flex-none",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-white text-2xl font-black",children:"Dashboard"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Here's your progress for today. Keep going!"})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Add New Goal"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 flex-1 min-h-0",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-3 min-h-0",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-[22px] font-bold pb-4",children:"Today's Focus"}),e.jsxs("div",{className:"flex flex-col divide-y divide-white/10",children:[e.jsxs("label",{className:"flex gap-x-4 py-4 items-center",children:[e.jsx("input",{className:"h-5 w-5 rounded-full border-white/30 border-2 bg-transparent text-primary checked:bg-primary checked:border-primary",type:"checkbox",checked:!1,readOnly:!0}),e.jsx("p",{className:"text-white/80 text-base",children:"Meditate for 10 minutes"})]}),e.jsxs("label",{className:"flex gap-x-4 py-4 items-center",children:[e.jsx("input",{className:"h-5 w-5 rounded-full border-white/30 border-2 bg-transparent text-primary checked:bg-primary checked:border-primary",type:"checkbox",checked:!0,readOnly:!0}),e.jsx("p",{className:"text-white/80 text-base line-through text-white/50",children:"Read 1 chapter of a book"})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-[22px] font-bold pb-4",children:"Active Goals"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Gs,{title:"Learn Spanish Fluently",progress:45,description:""}),e.jsx(Gs,{title:"Run a Half Marathon",progress:75,description:""})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 min-h-0",children:[e.jsxs("div",{className:"glass-panel p-3",children:[e.jsx("h4",{className:"text-white text-lg font-semibold",children:"Ongoing Challenge"}),e.jsx(Lr,{title:"30-Day Meditation",days:"12 / 30 Days",description:"Complete your daily session to keep the streak alive."})]}),e.jsxs("div",{className:"glass-panel p-3",children:[e.jsx("h4",{className:"text-white text-lg font-semibold",children:"Progress Overview"}),e.jsxs("div",{className:"flex items-center justify-center mt-3",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:"65%"}),e.jsx("div",{className:"text-sm text-white/60",children:"Weekly Habits"})]})]})]})]})]}),qr=()=>e.jsx("div",{className:`w-full h-full pointer-events-none min-h-0 overflow-hidden ${ye.previewRoot}`,children:e.jsxs("div",{className:`p-3 ${ye.glassPanelOverride}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-center bg-cover",style:{backgroundImage:"url('https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=300&q=80')"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Alex Mercer"}),e.jsx("p",{className:"text-white/70",children:"alex@example.com"}),e.jsxs("div",{className:"mt-3 flex gap-3",children:[e.jsx("span",{className:"p-2 bg-accent/10 text-accent rounded",children:"Edit Profile"}),e.jsx("span",{className:"p-2 bg-white/10 rounded",children:"Settings"})]})]})]}),e.jsxs("div",{className:`${ye.statGrid} mt-4`,children:[e.jsx("div",{className:ye.smallCard,children:e.jsx(ds,{value:24,label:"Habits"})}),e.jsx("div",{className:ye.smallCard,children:e.jsx(ds,{value:8,label:"Goals"})}),e.jsx("div",{className:ye.smallCard,children:e.jsx(ds,{value:12,label:"Challenges"})})]})]})}),Gr=()=>e.jsx("div",{className:"w-full h-full pointer-events-none min-h-0 overflow-hidden",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 min-h-0",children:[{id:"c1",title:"30-Day Meditation",days:"12 / 30 Days"},{id:"c2",title:"21-Day Fitness",days:"5 / 21 Days"}].map(t=>e.jsx("div",{className:"glass-card p-3 h-28 flex flex-col justify-center",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:t.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.days})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Streak 7"})]})},t.id))})}),Ur=()=>e.jsx("div",{className:"w-full h-full pointer-events-none min-h-0 overflow-hidden flex flex-col",children:e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold",children:"Медитация"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ежедневная практика для фокусировки ума"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"14 дней"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"w-full bg-white/10 h-3 rounded overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-gold",style:{width:"68%"}})})}),e.jsx("div",{className:"mt-3 text-sm text-muted-foreground",children:"История выполнения и небольшая статистика за месяц."})]})}),Vr=()=>{const t=[{title:"Dashboard",subtitle:"Главная",icon:e.jsx(ta,{className:"w-5 h-5"}),description:"Карточки привычек, целей, вызовов с прогресс-барами и магическим свечением",preview:e.jsx(Ar,{})},{title:"Habit Detail",subtitle:"Детали привычки",icon:e.jsx(aa,{className:"w-5 h-5"}),description:"Графики прогресса, история, статистика streak-ов",preview:e.jsx(Ur,{})},{title:"Challenges",subtitle:"Вызовы",icon:e.jsx(Qe,{className:"w-5 h-5"}),description:"Каталог челленджей с фильтрами по категориям",preview:e.jsx(Gr,{})},{title:"Profile",subtitle:"Профиль",icon:e.jsx(ra,{className:"w-5 h-5"}),description:"Аватар-кристалл, статистика, достижения, streak-и",preview:e.jsx(qr,{})}];return e.jsxs("section",{className:"relative py-24 px-4 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-purple-deep/20 via-transparent to-purple-deep/20"}),e.jsxs("div",{className:"container mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsxs("h2",{className:"section-title text-foreground",children:["Дизайн ",e.jsx("span",{className:"text-gradient-magic",children:"приложения"})]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Превью основных экранов SPA в едином магическом стиле"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:t.map(s=>e.jsxs("div",{className:"glass-card-strong overflow-hidden group hover:-translate-y-1 transition-all duration-500",children:[e.jsxs("div",{className:"aspect-video bg-gradient-to-br from-card to-secondary/50 p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-turquoise/10"}),e.jsx("div",{className:"relative z-10 h-full",children:s.preview})]}),e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/20 text-primary",children:s.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display font-bold text-foreground",children:s.title}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.subtitle})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]},s.title))})]})]})},Hr=()=>e.jsxs("section",{className:"relative py-24 px-4 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-secondary/30 to-transparent"}),e.jsxs("div",{className:"container mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 glass-card text-sm mb-4",children:[e.jsx(la,{className:"w-4 h-4 text-turquoise"}),e.jsx("span",{className:"text-muted-foreground",children:"Для разработчиков"})]}),e.jsx("h2",{className:"section-title text-foreground",children:"Архитектура и краткий обзор API"})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-start",children:[e.jsxs("div",{className:"glass-card-strong p-8 space-y-8",children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"Архитектура приложения"}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"glass-card p-4 w-full max-w-xs text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx(ia,{className:"w-5 h-5 text-turquoise"}),e.jsx("span",{className:"font-mono text-sm text-foreground",children:"Client"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"React SPA + TypeScript"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-0.5 h-8 bg-gradient-to-b from-turquoise to-gold"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"HTTP / REST"}),e.jsx("div",{className:"w-0.5 h-8 bg-gradient-to-b from-gold to-purple-light"})]}),e.jsxs("div",{className:"glass-card p-4 w-full max-w-xs text-center border-turquoise/30 border",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx(na,{className:"w-5 h-5 text-gold"}),e.jsx("span",{className:"font-mono text-sm text-foreground",children:"API Server"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"REST endpoints"})]}),e.jsx("div",{className:"w-0.5 h-12 bg-gradient-to-b from-purple-light to-crystal"}),e.jsxs("div",{className:"glass-card p-4 w-full max-w-xs text-center border-purple-light/30 border",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx(ca,{className:"w-5 h-5 text-purple-light"}),e.jsx("span",{className:"font-mono text-sm text-foreground",children:"Database / Storage"})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Firestore"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"Краткий обзор API"}),e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Основные ресурсы приложения:"}),e.jsxs("ul",{className:"list-disc pl-5 mt-2 text-sm text-muted-foreground space-y-1",children:[e.jsxs("li",{children:[e.jsx("code",{className:"font-mono",children:"/api/habits"})," — привычки (GET/POST), PATCH/DELETE по id."]}),e.jsxs("li",{children:[e.jsx("code",{className:"font-mono",children:"/api/goals"})," — цели (GET/POST) и управление ими."]}),e.jsxs("li",{children:[e.jsx("code",{className:"font-mono",children:"/api/me"})," — профиль текущего пользователя (GET/PATCH)."]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Для подробной документации откройте полную страницу API:"}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3 justify-center md:justify-start",children:[e.jsx(U,{to:"/public/api",className:"inline-block px-4 py-2 rounded bg-turquoise text-background font-medium",children:"Полная документация API"}),e.jsx(U,{to:"/public/swagger",className:"inline-block px-4 py-2 rounded bg-gold text-background font-medium",children:"Открыть Swagger UI"})]}),e.jsxs("div",{className:"mt-6 glass-card p-4",children:[e.jsx("h4",{className:"text-md font-semibold text-foreground mb-2",children:"Для разработчиков"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Кратко об архитектуре и инструментах, которые используются в проекте:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground list-disc pl-5 space-y-1",children:[e.jsx("li",{children:"Frontend: React + TypeScript, Vite, Tailwind CSS."}),e.jsx("li",{children:"State: Redux Toolkit (slices, createAsyncThunk) + React Router."}),e.jsx("li",{children:"Backend: Firebase (Firestore) / REST API."}),e.jsx("li",{children:"Tests & CI: Vitest (unit), Storybook + visual tests, Cypress (E2E), GitHub Actions для автоматизации."})]}),e.jsx("div",{className:"mt-3",children:e.jsx("a",{href:"https://github.com/Leg15Coder/frontend_second_term",target:"_blank",rel:"noreferrer",className:"inline-block px-3 py-1 rounded bg-muted-foreground/5 text-sm text-foreground",children:"Репозиторий на GitHub"})})]})]})]})]})]})]})]}),zr=()=>{const t=[{name:"React",icon:"⚛️",color:"text-crystal"},{name:"TypeScript",icon:"📘",color:"text-turquoise"},{name:"Redux Toolkit",icon:"🔄",color:"text-purple-light"},{name:"React Router",icon:"🧭",color:"text-gold"},{name:"REST API",icon:"🌐",color:"text-turquoise"},{name:"SCSS Modules",icon:"🎨",color:"text-magic-pink"},{name:"Jest / RTL",icon:"🧪",color:"text-gold"},{name:"Cypress",icon:"🌲",color:"text-turquoise"}],s=["Статический лендинг на Github Pages","Ссылка на прототип SPA","Документация и README","CI/CD настройка"];return e.jsx("section",{className:"relative py-24 px-4 overflow-hidden",children:e.jsxs("div",{className:"container mx-auto relative z-10",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsxs("h2",{className:"section-title text-foreground",children:["Формат ",e.jsx("span",{className:"text-gradient-gold",children:"сдачи"})," и стек"]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Версия 1.0 — MVP с современным технологическим стеком"})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"Технологии"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:t.map((a,r)=>e.jsxs("div",{className:"glass-card p-4 text-center group hover:scale-105 transition-transform duration-300",children:[e.jsx("div",{className:"text-3xl mb-2 group-hover:scale-110 transition-transform",children:a.icon}),e.jsx("span",{className:`text-sm font-medium ${a.color}`,children:a.name})]},r))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-display text-xl font-bold text-foreground",children:"MVP формат"}),e.jsx("div",{className:"glass-card-strong p-6 space-y-4",children:s.map((a,r)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"w-5 h-5 text-gold flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:a})]},r))})]})]})]})})},Wr=()=>{const{toast:t}=Ds(),s=()=>{t({title:"В разработке",description:"Видео демонстрация скоро будет доступна"})},a=()=>{const r=document.createElement("a");r.href="/presentation.html",r.download="Motify-presentation.html",document.body.appendChild(r),r.click(),r.remove(),t({title:"Загрузка началась",description:"Презентация Motify скачивается"})};return e.jsxs("section",{className:"relative py-32 px-4 overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-purple-deep via-background to-background"}),e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-primary/20 blur-3xl rounded-full"}),e.jsx("div",{className:"absolute bottom-20 left-1/4 w-64 h-64 bg-gold/15 blur-3xl rounded-full"}),e.jsx("div",{className:"absolute bottom-10 right-1/4 w-80 h-80 bg-turquoise/10 blur-3xl rounded-full"}),e.jsx("div",{className:"absolute bottom-40 left-20 animate-float",style:{animationDelay:"0s"},children:e.jsx(xe,{className:"w-12 h-12 opacity-30",glowColor:"gold"})}),e.jsx("div",{className:"absolute bottom-60 right-32 animate-float",style:{animationDelay:"2s"},children:e.jsx(xe,{className:"w-8 h-8 opacity-30",glowColor:"turquoise"})}),e.jsx("div",{className:"absolute bottom-20 right-20 animate-float",style:{animationDelay:"4s"},children:e.jsx(xe,{className:"w-10 h-10 opacity-30",glowColor:"purple"})}),Array.from({length:20}).map((r,l)=>e.jsx("div",{className:"absolute w-1 h-1 bg-gold rounded-full animate-float opacity-40",style:{left:`${10+Math.random()*80}%`,bottom:`${Math.random()*50}%`,animationDelay:`${Math.random()*5}s`,animationDuration:`${4+Math.random()*4}s`}},`particle-${l}`))]}),e.jsx("div",{className:"container mx-auto relative z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-8",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 glass-card text-sm animate-pulse-glow",children:[e.jsx(le,{className:"w-4 h-4 text-gold"}),e.jsx("span",{className:"text-gold",children:"Присоединяйся к нам"})]}),e.jsxs("h2",{className:"text-4xl md:text-5xl lg:text-6xl font-display font-bold text-foreground leading-tight",children:["Помогите превратить"," ",e.jsx("span",{className:"text-gradient-magic",children:"прокачку привычек"})," ","в увлекательный опыт"]}),e.jsx("p",{className:"text-xl текст-muted-foreground max-w-2xl mx-auto",children:"Вместе мы создадим приложение, которое меняет отношение людей к саморазвитию. Каждая привычка — это шаг к лучшей версии себя."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center pt-4",children:[e.jsxs(U,{to:"/investment",className:"btn-magic flex items-center justify-center gap-2 group text-lg",children:[e.jsx(oa,{className:"w-5 h-5"}),"Инвестировать в идею",e.jsx(Cs,{className:"w-4 h-4 transition-transform group-hover:translate-x-1"})]}),e.jsxs("button",{onClick:s,className:"btn-outline-magic flex items-center justify-center gap-2 text-lg",children:[e.jsx(at,{className:"w-5 h-5"}),"Посмотреть демо"]}),e.jsxs("button",{onClick:a,className:"glass-card px-6 py-4 flex items-center justify-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(da,{className:"w-5 h-5"}),"Скачать презентацию"]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-8 pt-8 border-t border-border/30",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gold",children:"$50K"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Цель инвестиций"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-turquoise",children:"Q1 2026"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Запуск бета-версии"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-light",children:"100K+"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Целевая аудитория"})]})]})]})})]})},Br=()=>e.jsx("footer",{className:"relative py-16 px-4 border-t border-border/30",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-12",children:[e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"w-8 h-8",glowColor:"gold"}),e.jsx("span",{className:"font-display text-xl font-bold text-foreground",children:"Motify"})]}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Превращаем рутину в приключение. Прокачивай привычки, достигай целей, становись лучшей версией себя."}),e.jsx("div",{className:"flex gap-4",children:[{icon:e.jsx(Qs,{className:"w-5 h-5"}),href:"https://github.com/Leg15Coder",label:"GitHub"},{icon:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24","aria-hidden":!0,fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"central",fontFamily:"Arial, Helvetica, sans-serif",fontWeight:"700",fontSize:"22",children:"vk"})}),href:"https://vk.com/dimkaryaz",label:"VK"},{icon:e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24","aria-hidden":!0,fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 2L11 13"}),e.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z"})]}),href:"https://t.me/dimka_ryaz",label:"Telegram"},{icon:e.jsx(ke,{className:"w-5 h-5"}),href:"mailto:ryazhskikh.dima.76@mail.ru",label:"Email"}].map(t=>e.jsx("a",{href:t.href,"aria-label":t.label,target:"_blank",rel:"noopener noreferrer",className:"p-2 glass-card text-muted-foreground hover:text-gold transition-colors",children:t.icon},t.label))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-display font-bold text-foreground",children:"Продукт"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{to:"/public/features",className:"block text-muted-foreground hover:text-foreground transition-colors",children:"Функции"}),e.jsx(U,{to:"/public/roadmap",className:"block text-muted-foreground hover:text-foreground transition-colors",children:"Roadmap"}),e.jsx(U,{to:"/public/api",className:"block text-muted-foreground hover:text-foreground transition-colors",children:"Документация"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-display font-bold text-foreground",children:"Компания"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{to:"/about",className:"block text-muted-foreground hover:text-foreground transition-colors",children:"О нас"}),e.jsx(U,{to:"/blog",className:"block text-muted-foreground hover:text-foreground transition-colors",children:"Блог"}),e.jsx(U,{to:"/contacts",className:"block text-muted-foreground hover:text-foreground transition-colors",children:"Контакты"})]})]})]}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-border/30 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"© 2026 Motify. Все права защищены."}),e.jsxs("div",{className:"flex gap-6 text-sm text-muted-foreground",children:[e.jsx("a",{href:"#",className:"hover:text-foreground transition-colors",children:"Политика конфиденциальности"}),e.jsx("a",{href:"#",className:"hover:text-foreground transition-colors",children:"Условия использования"})]})]})]})}),Ot=()=>(c.useEffect(()=>{document.title="Motify — Магический трекер привычек и целей"},[]),e.jsxs("div",{className:"min-h-screen bg-background text-foreground overflow-x-hidden",children:[e.jsx(Pe,{}),e.jsx(yr,{}),e.jsxs("main",{children:[e.jsx("section",{id:"hero",children:e.jsx(Sr,{})}),e.jsx("section",{id:"problem",children:e.jsx(Tr,{})}),e.jsx("section",{id:"features",children:e.jsx(Dr,{})}),e.jsx("section",{id:"scenarios",children:e.jsx(Pr,{})}),e.jsx("section",{id:"screens",children:e.jsx(Vr,{})}),e.jsx("section",{id:"api",children:e.jsx(Hr,{})}),e.jsx("section",{id:"tech",children:e.jsx(zr,{})}),e.jsx(Wr,{})]}),e.jsx(Br,{})]}));function Jr(){return e.jsx(Ot,{})}const Yr=()=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}),ce=({children:t})=>{const s=Ns(),{loading:a,isAuthenticated:r,error:l}=q(i=>i.user);return l&&!a?e.jsx(Is,{to:"/login",state:{from:s},replace:!0}):a?e.jsx(Yr,{}):r?t?e.jsx(e.Fragment,{children:t}):e.jsx(xa,{}):e.jsx(Is,{to:"/login",state:{from:s},replace:!0})},Kr=()=>{const t=Ns(),s=q(l=>l.user.me),a=[{path:"/dashboard",icon:"dashboard",label:"Главная",filled:!0},{path:"/habits",icon:"checklist",label:"Привычки"},{path:"/goals",icon:"flag",label:"Цели"},{path:"/todos",icon:"task_alt",label:"Задачи"},{path:"/challenges",icon:"shield",label:"Вызовы"},{path:"/groups",icon:"groups",label:"Группы"},{path:"/calendar",icon:"calendar_month",label:"Календарь"}],r=l=>t.pathname===l;return e.jsx("aside",{className:"w-64 p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex h-full flex-col justify-between glass-panel p-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(U,{to:"/profile",className:"flex gap-3 items-center hover:bg-white/5 rounded-lg p-2 -ml-2 transition-colors cursor-pointer","aria-label":"Открыть профиль",title:"Перейти в профиль",children:[e.jsx("div",{className:"bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-accent/50",style:{backgroundImage:`url(${s?.photoURL||"/placeholder-avatar.svg"})`}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-white text-base font-medium leading-normal",children:s?.name||"Пользователь"}),e.jsx("p",{className:"text-white/60 text-sm font-normal leading-normal",children:"С возвращением"})]})]}),e.jsx("div",{className:"flex flex-col gap-2 mt-6",children:a.map(l=>e.jsxs(U,{to:l.path,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${r(l.path)?"bg-white/10 border border-white/20":"hover:bg-white/5"}`,children:[e.jsx("span",{className:`material-symbols-outlined ${r(l.path)?"text-accent":"text-white/80"}`,style:l.filled&&r(l.path)?{fontVariationSettings:"'FILL' 1"}:{},children:l.icon}),e.jsx("p",{className:`text-sm font-medium leading-normal ${r(l.path)?"text-white":"text-white/80"}`,children:l.label})]},l.path))})]}),e.jsx("div",{className:"flex flex-col gap-1",children:e.jsxs(U,{to:"/settings",className:"flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/5 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-white/80",children:"settings"}),e.jsx("p",{className:"text-white/80 text-sm font-medium leading-normal",children:"Настройки"})]})})]})})},Z=({children:t})=>e.jsxs("div",{className:"relative min-h-screen w-full overflow-x-hidden",children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden -z-10",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[500px] h-[500px] bg-primary/20 rounded-full blur-[150px] animate-pulse"}),e.jsx("div",{className:"absolute bottom-[-15%] right-[-15%] w-[600px] h-[600px] bg-accent/10 rounded-full blur-[150px] animate-pulse"}),e.jsx("div",{className:"absolute top-[30%] right-[5%] w-[400px] h-[400px] bg-[#1B1038] rounded-full blur-[120px]"})]}),e.jsxs("div",{className:"flex h-full min-h-screen w-full",children:[e.jsx(Kr,{}),e.jsx("main",{className:"flex-1 p-8",children:t})]})]}),Zr="_loader_hbguo_1",Xr={loader:Zr},Qr=({size:t=24})=>e.jsx("div",{className:Xr.loader,style:{width:t,height:t}}),el="_banner_1bqmc_1",sl="_message_1bqmc_2",tl="_retry_1bqmc_3",xs={banner:el,message:sl,retry:tl},al=({message:t="An error occurred",onRetry:s})=>e.jsxs("div",{className:xs.banner,role:"alert",children:[e.jsx("div",{className:xs.message,children:t}),s&&e.jsx("button",{className:xs.retry,onClick:s,"aria-label":"Retry",children:"Retry"})]}),rl=({loading:t,error:s,onRetry:a,size:r=40})=>t?e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:24},children:e.jsx(Qr,{size:r})}):s?e.jsx(al,{message:s,onRetry:a}):null,ll=()=>{const t=X(),{items:s,loading:a,error:r}=q(v=>v.challenges),l=q(v=>v.user.me);c.useEffect(()=>{console.log("[ChallengeWidget] Fetching challenges..."),t(Ts())},[t]),c.useEffect(()=>{console.log("[ChallengeWidget] Redux challenges updated:",{count:s.length,items:s.map(v=>({id:v.id,title:v.title,participants:v.participants?.length||0}))})},[s]);const i=ma.useMemo(()=>{if(console.log("[ChallengeWidget] Computing currentChallenge from challenges:",s.length),!s?.length){console.log("[ChallengeWidget] No challenges available!");return}const v=s.find(P=>P.id==="demo-30-day-challenge");return v?(console.log("[ChallengeWidget] Found demo-30-day-challenge:",{id:v.id,participants:v.participants?.length||0,participantsList:v.participants}),v):(console.log("[ChallengeWidget] demo-30-day-challenge NOT FOUND! Using fallback..."),s.reduce((P,A)=>{const b=P?.participants?.length??0;return(A?.participants?.length??0)>b?A:P},s[0]))},[s]);if(c.useEffect(()=>{i&&l&&console.log("[ChallengeWidget] Current state:",{challengeId:i.id,userId:l.id,participants:i.participants,isParticipating:i.participants?.includes(l.id)})},[i,l]),a&&!i)return e.jsx("div",{className:"glass-panel p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})})});if(r)return e.jsx("div",{className:"glass-panel p-6",children:e.jsx("p",{className:"text-red-400 text-sm",children:r})});if(!i)return e.jsx("div",{className:"glass-panel p-6",children:e.jsx("p",{className:"text-white/60 text-sm",children:"Нет доступных вызовов"})});const m=l?.id??"",o=i?.participants??[],n=m&&o.includes(m),x=i?.dailyChecks?.[m]??[],h=new Date().toISOString().split("T")[0],f=x.includes(h),N=i&&i.days>0?x.length/i.days*100:0,k=async()=>{if(!m){d.error("Необходимо авторизоваться");return}console.log("[ChallengeWidget] Joining challenge:",{challengeId:i.id,userId:m,currentParticipants:o});try{const v=await t(bt({challengeId:i.id,userId:m})).unwrap();console.log("[ChallengeWidget] Join successful! New state:",{participants:v.participants,isNowParticipating:v.participants?.includes(m)}),console.log("[ChallengeWidget] Redux state after join:",{allChallenges:s.length,firstChallenge:s[0]}),d.success("Вы присоединились к вызову!")}catch(v){console.error("[ChallengeWidget] Join failed with error:",v),console.error("[ChallengeWidget] Error type:",typeof v),console.error("[ChallengeWidget] Error details:",JSON.stringify(v,null,2));const P=v instanceof Error?v.message:String(v);P.toLowerCase().includes("permission")||P.toLowerCase().includes("denied")?(d.error("Ошибка доступа к Firestore! Проверьте правила безопасности."),console.error("[ChallengeWidget] FIRESTORE PERMISSION DENIED! Правила не опубликованы!")):d.error(`Не удалось присоединиться: ${P}`)}},E=async()=>{if(m)try{await t(jt({challengeId:i.id,userId:m})).unwrap(),d.success("Вы покинули вызов")}catch{d.error("Не удалось покинуть вызов")}},y=async()=>{if(!m){d.error("Необходимо авторизоваться");return}if(!n){d.error("Сначала присоединитесь к вызову");return}try{await t(gt({challengeId:i.id,userId:m})).unwrap(),d.success("День отмечен!")}catch{d.error("Не удалось отметить день")}},u=async()=>{if(!m){d.error("Необходимо авторизоваться");return}try{await t(ft({challengeId:i.id,userId:m})).unwrap(),d.success("Отметка отменена")}catch{d.error("Не удалось отменить отметку")}};return e.jsxs("div",{className:"glass-panel p-6","data-testid":"challenge-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white text-xl font-bold",children:"Текущий вызов"}),n&&e.jsx("span",{className:"text-xs bg-accent/20 text-accent px-2 py-1 rounded-full",children:"Участвуете"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold text-lg mb-1",children:i.title}),i.description&&e.jsx("p",{className:"text-white/60 text-sm mb-3",children:i.description}),e.jsxs("p",{className:"text-white/80 text-sm",children:["Продолжительность: ",i.days," дней"]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/80 text-sm",children:"Прогресс"}),e.jsxs("span",{className:"text-white text-sm font-semibold",children:[x.length," / ",i.days," дней"]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:e.jsx("div",{className:"bg-accent h-2 rounded-full transition-all",style:{width:`${Math.min(N,100)}%`}})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{"data-testid":"challenge-checkin-btn",onClick:y,disabled:f,"aria-label":f?"Уже отмечено сегодня":"Отметить день как выполненный",className:`flex-1 px-4 py-2 rounded-lg transition-colors ${f?"bg-green-500/20 text-green-400 cursor-not-allowed":"bg-accent/20 text-accent hover:bg-accent/30"}`,children:f?"✓ Отмечено сегодня":"Отметить день"}),f&&e.jsx("button",{"data-testid":"challenge-undo-btn",onClick:u,"aria-label":"Отменить отметку",className:"px-4 py-2 rounded-lg bg-orange-500/10 text-orange-400 hover:bg-orange-500/20 transition-colors",children:"Отменить"}),e.jsx("button",{onClick:E,"aria-label":"Покинуть вызов",className:"px-4 py-2 rounded-lg bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-colors",children:"Выйти"})]})]}),!n&&e.jsx("button",{onClick:k,"aria-label":"Присоединиться к вызову",className:"w-full px-4 py-2 rounded-lg bg-accent text-white hover:bg-accent/80 transition-colors",children:"Присоединиться"}),o.length>0&&e.jsxs("p",{className:"text-white/60 text-xs",children:["Участников: ",o.length]})]})]})},il=({todos:t,habits:s})=>{const a=x=>{if("deadline"in x&&x.deadline){const h=new Date(x.deadline),f=new Date;return Math.ceil((h.getTime()-f.getTime())/(1e3*60*60*24))<=3}return!1},r=x=>x.difficulty==="high"||x.difficulty==="medium",l=[...t,...s].filter(x=>a(x)&&r(x)&&!x.completed),i=[...t,...s].filter(x=>!a(x)&&r(x)&&!x.completed),m=[...t,...s].filter(x=>a(x)&&!r(x)&&!x.completed),o=[...t,...s].filter(x=>!a(x)&&!r(x)&&!x.completed),n=x=>{const h="frequency"in x;return e.jsx("div",{className:"p-2 bg-white/5 rounded hover:bg-white/10 transition-colors cursor-pointer",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm text-white/60",children:h?"checklist":"task_alt"}),e.jsxs("p",{className:"text-white/80 text-sm flex-1",children:[x.title.slice(0,40),x.title.length>40?"...":""]})]})},x.id)};return e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-xl font-bold mb-4",children:"Матрица Эйзенхауэра"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("h3",{className:"text-white font-semibold text-sm",children:"Срочно и Важно"})]}),e.jsx("div",{className:"space-y-2 min-h-[100px] max-h-[300px] overflow-y-auto",children:l.length===0?e.jsx("p",{className:"text-white/40 text-xs",children:"Нет задач"}):l.map(n)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"text-white font-semibold text-sm",children:"Не срочно, но Важно"})]}),e.jsx("div",{className:"space-y-2 min-h-[100px] max-h-[300px] overflow-y-auto",children:i.length===0?e.jsx("p",{className:"text-white/40 text-xs",children:"Нет задач"}):i.map(n)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("h3",{className:"text-white font-semibold text-sm",children:"Срочно, но не Важно"})]}),e.jsx("div",{className:"space-y-2 min-h-[100px] max-h-[300px] overflow-y-auto",children:m.length===0?e.jsx("p",{className:"text-white/40 text-xs",children:"Нет задач"}):m.map(n)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full"}),e.jsx("h3",{className:"text-white font-semibold text-sm",children:"Не срочно и не Важно"})]}),e.jsx("div",{className:"space-y-2 min-h-[100px] max-h-[300px] overflow-y-auto",children:o.length===0?e.jsx("p",{className:"text-white/40 text-xs",children:"Нет задач"}):o.map(n)})]})]})]})};function nl(){const[t,s]=c.useState(!1),[a,r]=c.useState(null),[l,i]=c.useState(!1);c.useEffect(()=>{const h=Nt.onAuthStateChanged(f=>{if(f&&!f.emailVerified){const N=f.metadata.creationTime||new Date().toISOString(),k=new Date(N).getTime(),E=Date.now(),y=Math.floor((E-k)/(1440*60*1e3)),u=Math.max(0,7-y);r(u),s(!0),u===0&&console.warn("Account will be deleted today!")}else s(!1)});return()=>h()},[]);const m=async()=>{i(!0);try{await Y.sendVerificationEmail(),d.success("Письмо отправлено! Проверьте вашу почту.")}catch(h){const f=h instanceof Error?h.message:"Не удалось отправить письмо";d.error(f)}finally{i(!1)}},o=ie();if(!t)return null;const n=a!==null&&a<=2,x=a===0;return e.jsxs(ss,{variant:x?"destructive":"default",className:`mb-6 ${n?"border-orange-500 bg-orange-500/10":""} ${x?"border-red-500 bg-red-500/10 animate-pulse":""}`,children:[e.jsx(Ze,{className:"h-5 w-5"}),e.jsxs(Ft,{className:"flex items-center gap-2 text-lg font-bold",children:[x?"🚨 Срочно!":"⚠️ Email не подтвержден",a!==null&&e.jsxs("span",{className:"flex items-center gap-1 text-sm font-normal",children:[e.jsx(ha,{className:"h-4 w-4"}),x?"Аккаунт будет удален сегодня!":`Осталось ${a} ${cl(a)}`]})]}),e.jsxs(ts,{className:"mt-2 space-y-3",children:[e.jsx("p",{children:x?"Ваш аккаунт будет автоматически удален в конце дня, если вы не подтвердите email.":"Подтвердите ваш email для полного доступа ко всем функциям. Неподтвержденные аккаунты удаляются через 7 дней."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(R,{size:"sm",onClick:()=>o("/verify-email"),variant:x?"destructive":"default",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Подтвердить email"]}),e.jsx(R,{size:"sm",variant:"outline",onClick:m,disabled:l,children:l?"Отправка...":"Отправить письмо повторно"})]}),x&&e.jsx("p",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:"⏰ Действуйте немедленно, чтобы сохранить ваш аккаунт и данные!"})]})]})}function cl(t){return t===1?"день":t>=2&&t<=4?"дня":"дней"}const ve=ua,Fe=pa,ol=ga,At=c.forwardRef(({className:t,...s},a)=>e.jsx(it,{ref:a,className:S("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));At.displayName=it.displayName;const he=c.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(ol,{children:[e.jsx(At,{}),e.jsxs(rt,{ref:r,className:S("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a,children:[s,e.jsxs(fa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));he.displayName=rt.displayName;const ue=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});ue.displayName="DialogHeader";const pe=({className:t,...s})=>e.jsx("div",{className:S("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});pe.displayName="DialogFooter";const ge=c.forwardRef(({className:t,...s},a)=>e.jsx(lt,{ref:a,className:S("text-lg font-semibold leading-none tracking-tight",t),...s}));ge.displayName=lt.displayName;const dl=c.forwardRef(({className:t,...s},a)=>e.jsx(nt,{ref:a,className:S("text-sm text-muted-foreground",t),...s}));dl.displayName=nt.displayName;const Se=c.forwardRef(({className:t,...s},a)=>e.jsx("textarea",{className:S("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s}));Se.displayName="Textarea";const xl=()=>{const t=X(),s=ie(),{items:a,loading:r,error:l}=q(g=>g.habits),{items:i,loading:m,error:o}=q(g=>g.goals),{items:n,loading:x}=q(g=>g.todos),h=q(g=>g.user.me?.id),[f,N]=c.useState(!1),[k,E]=c.useState(""),[y,u]=c.useState(""),[v,P]=c.useState(""),[A,b]=c.useState(!1),[T,L]=c.useState(null),[w,_]=c.useState(""),[M,F]=c.useState(""),[D,$]=c.useState("");c.useEffect(()=>{h&&a.length===0&&(t(_e(h)),t(Je(h)),t(gs(h)))},[t,h,a.length]),c.useEffect(()=>{console.log("[Dashboard] habits changed:",a)},[a]);const p=r||m||x,C=l??o,z=()=>{h&&(t(_e(h)),t(Je(h)),t(gs(h)))},K=async()=>{const{auth:g}=await de(async()=>{const{auth:H}=await import("./index-Cnf75vxI.js").then(ae=>ae.H);return{auth:H}},__vite__mapDeps([0,1,2]));if(!k.trim()){d.error("Введите название задачи");return}const B=g.currentUser?.uid;if(!B){d.error("Необходима авторизация");return}h!==B&&console.warn("userId mismatch! Redux:",h,"Firebase:",B);try{await t(wt({title:k,description:y,deadline:v,userId:B})).unwrap(),d.success("Задача добавлена!"),E(""),u(""),P(""),N(!1)}catch(H){const ae=H instanceof Error?H.message:String(H),je=ae.toLowerCase();if(je.includes("permission")||je.includes("insufficient")||je.includes("missing or insufficient permissions")){d.error("Операция не разрешена сервером Firestore (Missing or insufficient permissions). Проверьте и опубликуйте правила Firestore или используйте Firebase Emulator. См. README или инструкцию в проекте.");return}d.error(`Ошибка: ${ae}`)}},ne=async(g,B)=>{try{await t(vt({id:g,completed:B})).unwrap(),d.success(B?"Задача возвращена":"Задача выполнена!")}catch(H){const ae=H instanceof Error?H.message:String(H);if(ae.toLowerCase().includes("permission")||ae.toLowerCase().includes("insufficient")){d.error("Нет прав на обновление задачи в Firestore. Проверьте правила безопасности Firestore.");return}d.error("Не удалось обновить задачу")}},j=async g=>{try{await t(yt(g)).unwrap(),d.success("Задача удалена")}catch(B){const H=B instanceof Error?B.message:String(B);if(H.toLowerCase().includes("permission")||H.toLowerCase().includes("insufficient")){d.error("Нет прав на удаление задачи в Firestore. Проверьте правила безопасности Firestore.");return}d.error("Ошибка при удалении задачи")}},W=async g=>{const{auth:B}=await de(async()=>{const{auth:be}=await import("./index-Cnf75vxI.js").then(Ls=>Ls.H);return{auth:be}},__vite__mapDeps([0,1,2])),H=B.currentUser?.uid;if(!H){d.error("Необходима авторизация");return}if(!h)return;const ae=a.find(be=>be.id===g);if(!ae){console.error("Habit not found:",g);return}const je=new Date().toISOString().split("T")[0],Ps=ae.datesCompleted?.includes(je)||!1;console.log("Toggling habit:",{habitId:g,today:je,isCompleted:Ps,datesCompleted:ae.datesCompleted,reduxUserId:h,actualUserId:H}),t(kt({id:g,date:je}));try{await t(Ct({id:g,date:je})).unwrap(),d.success(Ps?"Привычка отмечена как невыполненная":"Привычка выполнена!")}catch(be){console.error("Failed to toggle habit:",be);const rs=(be instanceof Error?be.message:String(be)).toLowerCase();rs.includes("permission")||rs.includes("insufficient")||rs.includes("missing or insufficient")?d.error("Нет прав на обновление привычки в Firestore. Проверьте правила безопасности Firestore."):d.error("Не удалось обновить привычку"),await t(_e(H))}},V=a.slice(0,3),Oe=i.filter(g=>!g.completed).slice(0,2),fe=n.filter(g=>!g.completed),as=g=>{L(g.id),_(g.title||""),F(g.description||""),$(g.deadline||""),b(!0)},J=async()=>{if(!T)return;const g={title:w.trim(),description:M.trim()||void 0,deadline:D||void 0};try{await t(St({id:T,data:g})).unwrap(),d.success("Задача обновлена"),b(!1)}catch(B){const H=B instanceof Error?B.message:String(B);if(H.toLowerCase().includes("permission")||H.toLowerCase().includes("insufficient")){d.error("Нет прав на обновление задачи в Firestore. Проверьте правила безопасности Firestore.");return}d.error("Не удалось сохранить изменения")}};return e.jsxs(Z,{children:[e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsx(nl,{}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{"data-testid":"dashboard-title",className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Главная"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Вот ваш прогресс на сегодня. Продолжайте!"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{"data-testid":"add-habit-btn",onClick:()=>s("/habits?create=true"),className:"flex items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-accent/10 text-accent text-sm font-bold leading-normal tracking-[0.015em] border border-accent/80 shadow-glow-gold hover:shadow-glow-gold-hover transition-shadow duration-300",children:e.jsx("span",{className:"truncate",children:"+ Добавить привычку"})}),e.jsx("button",{"data-testid":"add-goal-btn",onClick:()=>s("/goals?create=true"),className:"flex items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-accent/10 text-accent text-sm font-bold leading-normal tracking-[0.015em] border border-accent/80 shadow-glow-gold hover:shadow-glow-gold-hover transition-shadow duration-300",children:e.jsx("span",{className:"truncate",children:"+ Добавить цель"})}),e.jsxs(ve,{open:f,onOpenChange:N,children:[e.jsx(Fe,{asChild:!0,children:e.jsx("button",{"data-testid":"add-task-btn",className:"flex items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-accent/10 text-accent text-sm font-bold leading-normal tracking-[0.015em] border border-accent/80 shadow-glow-gold hover:shadow-glow-gold-hover transition-shadow duration-300",children:e.jsx("span",{className:"truncate",children:"+ Добавить задачу"})})}),e.jsxs(he,{className:"glass-panel border-white/20",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:"Создать новую задачу"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dashboard-todo-title",className:"text-white/80 text-sm mb-2 block",children:"Название"}),e.jsx(G,{id:"dashboard-todo-title",value:k,onChange:g=>E(g.target.value),className:"bg-white/5 border-white/10 text-white",placeholder:"Например: Купить продукты"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dashboard-todo-description",className:"text-white/80 text-sm mb-2 block",children:"Описание (опционально)"}),e.jsx(Se,{id:"dashboard-todo-description",value:y,onChange:g=>u(g.target.value),className:"bg-white/5 border-white/10 text-white min-h-[80px]",placeholder:"Детали задачи..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dashboard-todo-deadline",className:"text-white/80 text-sm mb-2 block",children:"Дедлайн (опционально)"}),e.jsx(G,{id:"dashboard-todo-deadline",type:"datetime-local",value:v,onChange:g=>P(g.target.value),className:"bg-white/5 border-white/10 text-white"})]})]}),e.jsx(pe,{children:e.jsx(R,{onClick:K,className:"bg-primary text-white hover:bg-primary/90",children:"Создать"})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-8",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-[22px] font-bold leading-tight tracking-[-0.015em] pb-4",children:"Повседневные задачи"}),x?e.jsx("div",{className:"text-white/60",children:"Загрузка задач..."}):fe.length===0?e.jsx("div",{className:"text-white/60",children:"Нет активных задач. Создайте первую задачу!"}):e.jsx("div",{className:"flex flex-col gap-3",children:fe.map(g=>e.jsxs("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 flex items-start gap-3 group",children:[e.jsx("input",{className:"h-5 w-5 mt-0.5 rounded border-white/30 border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 transition-all duration-300 cursor-pointer",type:"checkbox",checked:g.completed,onChange:()=>ne(g.id,g.completed)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-white font-medium ${g.completed?"line-through text-white/50":""}`,children:g.title}),g.description&&e.jsx("p",{className:"text-white/60 text-sm mt-1",children:g.description}),g.deadline&&e.jsxs("p",{className:"text-accent text-xs mt-2",children:["📅 ",new Date(g.deadline).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>as(g),className:"opacity-0 group-hover:opacity-100 transition-opacity text-white/40 hover:text-accent","aria-label":"Редактировать задачу",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit"})}),e.jsx("button",{onClick:()=>j(g.id),className:"opacity-0 group-hover:opacity-100 transition-opacity text-white/40 hover:text-red-400","aria-label":"Удалить задачу",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})})]})]},g.id))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-[22px] font-bold leading-tight tracking-[-0.015em] pb-4",children:"Фокус на сегодня"}),r?e.jsx("div",{className:"text-white/60",children:"Загрузка привычек..."}):V.length===0?e.jsx("div",{className:"text-white/60",children:"Нет привычек. Создайте первую привычку чтобы начать!"}):e.jsx("div",{className:"flex flex-col divide-y divide-white/10",children:V.map(g=>{const B=new Date().toISOString().split("T")[0],H=g.datesCompleted?.includes(B)||!1;return e.jsxs("label",{"data-testid":"habit-card",className:"flex gap-x-4 py-4 items-center cursor-pointer group",children:[e.jsx("input",{"data-testid":"habit-complete-btn",className:"h-5 w-5 rounded-full border-white/30 border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 appearance-none transition-all duration-300 group-hover:border-primary cursor-pointer",type:"checkbox",checked:H,onChange:()=>W(g.id)}),e.jsx("p",{className:`text-base font-normal leading-normal transition-colors ${H?"text-white/50 line-through":"text-white/80 group-hover:text-white"}`,children:g.title})]},g.id)})})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-[22px] font-bold leading-tight tracking-[-0.015em] pb-4",children:"Активные цели"}),m?e.jsx("div",{className:"text-white/60",children:"Загрузка целей..."}):Oe.length===0?e.jsx("div",{className:"text-white/60",children:"Нет активных целей. Создайте первую цель!"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Oe.map(g=>e.jsxs("div",{"data-testid":"goal-card",className:"p-4 rounded-lg bg-white/5 border border-white/10 flex flex-col gap-3",children:[e.jsx("p",{className:"text-white font-semibold",children:g.title}),e.jsx("div",{className:"w-full bg-black/20 rounded-full h-2.5",children:e.jsx("div",{className:"bg-primary h-2.5 rounded-full",style:{width:`${g.progress||0}%`,boxShadow:"0 0 8px rgba(190, 52, 213, 0.7)"}})}),e.jsxs("p",{className:"text-sm text-white/60",children:[g.progress||0,"% завершено"]})]},g.id))})]})]}),e.jsxs("div",{className:"lg:col-span-1 flex flex-col gap-8",children:[e.jsx(ll,{}),e.jsx(il,{todos:fe,habits:V}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-[22px] font-bold leading-tight tracking-[-0.015em] pb-4",children:"Быстрая статистика"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-white/70",children:"Всего привычек"}),e.jsx("span",{className:"text-white font-bold text-xl",children:a.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-white/70",children:"Активных целей"}),e.jsx("span",{className:"text-white font-bold text-xl",children:i.filter(g=>!g.completed).length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-white/70",children:"Процент выполнения"}),e.jsxs("span",{className:"text-white font-bold text-xl",children:[a.length>0?Math.round(a.filter(g=>g.completed).length/a.length*100):0,"%"]})]})]})]})]})]})]}),e.jsx(rl,{loading:p,error:C,onRetry:z}),A&&e.jsx(ve,{open:A,onOpenChange:b,children:e.jsxs(he,{className:"glass-panel border-white/20",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:"Редактировать задачу"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dashboard-edit-title",className:"text-white/80 text-sm mb-2 block",children:"Название"}),e.jsx(G,{id:"dashboard-edit-title",value:w,onChange:g=>_(g.target.value),className:"bg-white/5 border-white/10 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dashboard-edit-desc",className:"text-white/80 text-sm mb-2 block",children:"Описание"}),e.jsx(Se,{id:"dashboard-edit-desc",value:M,onChange:g=>F(g.target.value),className:"bg-white/5 border-white/10 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dashboard-edit-deadline",className:"text-white/80 text-sm mb-2 block",children:"Дедлайн"}),e.jsx(G,{id:"dashboard-edit-deadline",type:"datetime-local",value:D,onChange:g=>$(g.target.value),className:"bg-white/5 border-white/10 text-white"})]})]}),e.jsx(pe,{children:e.jsx(R,{onClick:J,className:"bg-primary text-white",children:"Сохранить"})})]})})]})},fs=ja,js=ba,Ye=c.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(ct,{ref:r,className:S("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...a,children:[s,e.jsx(Na,{asChild:!0,children:e.jsx(ot,{className:"h-4 w-4 opacity-50"})})]}));Ye.displayName=ct.displayName;const qt=c.forwardRef(({className:t,...s},a)=>e.jsx(mt,{ref:a,className:S("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Ca,{className:"h-4 w-4"})}));qt.displayName=mt.displayName;const Gt=c.forwardRef(({className:t,...s},a)=>e.jsx(ht,{ref:a,className:S("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(ot,{className:"h-4 w-4"})}));Gt.displayName=ht.displayName;const Ke=c.forwardRef(({className:t,children:s,position:a="popper",...r},l)=>e.jsx(wa,{children:e.jsxs(dt,{ref:l,className:S("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:a,...r,children:[e.jsx(qt,{}),e.jsx(va,{className:S("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Gt,{})]})}));Ke.displayName=dt.displayName;const ml=c.forwardRef(({className:t,...s},a)=>e.jsx(ut,{ref:a,className:S("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));ml.displayName=ut.displayName;const oe=c.forwardRef(({className:t,children:s,...a},r)=>e.jsxs(xt,{ref:r,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ya,{children:e.jsx(ps,{className:"h-4 w-4"})})}),e.jsx(ka,{children:s})]}));oe.displayName=xt.displayName;const hl=c.forwardRef(({className:t,...s},a)=>e.jsx(pt,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",t),...s}));hl.displayName=pt.displayName;const ul=ys({title:Ne().min(1,"Title is required"),description:Ne().optional(),frequency:Ms(["daily","weekdays","custom","every_n_days"]).optional(),everyNDays:Sa().min(1).max(365).optional(),difficulty:Ms(["low","medium","hard"]).optional()}),pl=()=>{const t=X(),{items:s,loading:a,error:r}=q(u=>u.habits),l=q(u=>u.user.me?.id),[i,m]=c.useState(!1),[o,n]=c.useState(null),[x,h]=ks(),f=ws({resolver:vs(ul),defaultValues:{title:"",description:"",frequency:"daily",everyNDays:1,difficulty:"medium"}});c.useEffect(()=>{l&&t(_e(l))},[t,l]),c.useEffect(()=>{x.get("create")==="true"&&(n(null),f.reset(),m(!0),h({}))},[x,h,f]);const N=async u=>{o?await t($a({id:o,data:u})):await t(Pa({...u,completed:!1})),m(!1),n(null),f.reset()},k=u=>{const v=s.find(P=>P.id===u);v&&(n(u),f.reset({title:v.title,description:v.description??"",frequency:v.frequency??"daily",everyNDays:v.everyNDays??1,difficulty:v.difficulty??"medium"}),m(!0))},E=async u=>{confirm("Delete this habit?")&&await t(La(u))},y=async u=>{const{auth:v}=await de(async()=>{const{auth:T}=await import("./index-Cnf75vxI.js").then(L=>L.H);return{auth:T}},__vite__mapDeps([0,1,2])),P=v.currentUser?.uid;if(!P){d.error("Необходима авторизация");return}if(!s.find(T=>T.id===u))return;const b=new Date().toISOString().split("T")[0];t(kt({id:u,date:b}));try{await t(Ct({id:u,date:b})).unwrap(),d.success("Привычка обновлена")}catch(T){console.error("Failed to toggle habit on HabitsPage:",T),d.error("Не удалось обновить привычку"),await t(_e(P))}};return e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Привычки"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Отслеживайте свои ежедневные ритуалы и создавайте последовательность."})]}),e.jsxs(ve,{open:i,onOpenChange:m,children:[e.jsx(Fe,{asChild:!0,children:e.jsx("button",{"data-testid":"add-habit-btn",onClick:()=>{n(null),f.reset(),m(!0)},className:"flex items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-accent/10 text-accent text-sm font-bold leading-normal tracking-[0.015em] border border-accent/80 shadow-glow-gold hover:shadow-glow-gold-hover transition-shadow duration-300",children:e.jsx("span",{className:"truncate",children:"+ Добавить привычку"})})}),e.jsxs(he,{className:"glass-panel border-white/20",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:o?"Редактировать привычку":"Создать новую привычку"})}),e.jsx(_s,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(N),className:"space-y-4",children:[e.jsx(re,{control:f.control,name:"title",render:({field:u})=>e.jsxs(Q,{children:[e.jsx(ee,{className:"text-white/80",children:"Название"}),e.jsx(se,{children:e.jsx(G,{...u,className:"bg-white/5 border-white/10 text-white",placeholder:"например: Утренняя медитация"})}),e.jsx(te,{})]})}),e.jsx(re,{control:f.control,name:"description",render:({field:u})=>e.jsxs(Q,{children:[e.jsx(ee,{className:"text-white/80",children:"Описание (опционально)"}),e.jsx(se,{children:e.jsx(G,{...u,className:"bg-white/5 border-white/10 text-white",placeholder:"например: 15 минут осознанности"})}),e.jsx(te,{})]})}),e.jsx(re,{control:f.control,name:"frequency",render:({field:u})=>e.jsxs(Q,{children:[e.jsx(ee,{className:"text-white/80",children:"Периодичность"}),e.jsxs(fs,{onValueChange:u.onChange,defaultValue:u.value,children:[e.jsx(se,{children:e.jsx(Ye,{className:"bg-white/5 border-white/10 text-white",children:e.jsx(js,{placeholder:"Выберите периодичность"})})}),e.jsxs(Ke,{className:"bg-[#1a1f2e] border-white/10",children:[e.jsx(oe,{value:"daily",className:"text-white hover:bg-white/10",children:"Ежедневно"}),e.jsx(oe,{value:"weekdays",className:"text-white hover:bg-white/10",children:"По будням"}),e.jsx(oe,{value:"every_n_days",className:"text-white hover:bg-white/10",children:"Каждые N дней"}),e.jsx(oe,{value:"custom",className:"text-white hover:bg-white/10",children:"Выборочно"})]})]}),e.jsx(te,{})]})}),f.watch("frequency")==="every_n_days"&&e.jsx(re,{control:f.control,name:"everyNDays",render:({field:u})=>e.jsxs(Q,{children:[e.jsx(ee,{className:"text-white/80",children:"Каждые (дней)"}),e.jsx(se,{children:e.jsx(G,{type:"number",min:1,max:365,...u,onChange:v=>u.onChange(Number.parseInt(v.target.value,10)),className:"bg-white/5 border-white/10 text-white",placeholder:"например: 3"})}),e.jsx(te,{}),e.jsx("p",{className:"text-xs text-white/50",children:"Привычка будет повторяться каждые указанное количество дней"})]})}),e.jsx(re,{control:f.control,name:"difficulty",render:({field:u})=>e.jsxs(Q,{children:[e.jsx(ee,{className:"text-white/80",children:"Сложность"}),e.jsxs(fs,{onValueChange:u.onChange,defaultValue:u.value,children:[e.jsx(se,{children:e.jsx(Ye,{className:"bg-white/5 border-white/10 text-white",children:e.jsx(js,{placeholder:"Выберите сложность"})})}),e.jsxs(Ke,{className:"bg-[#1a1f2e] border-white/10",children:[e.jsx(oe,{value:"low",className:"text-white hover:bg-white/10",children:"Низкая"}),e.jsx(oe,{value:"medium",className:"text-white hover:bg-white/10",children:"Средняя"}),e.jsx(oe,{value:"hard",className:"text-white hover:bg-white/10",children:"Высокая"})]})]}),e.jsx(te,{})]})}),e.jsx(pe,{children:e.jsx(R,{type:"submit",className:"bg-primary text-white hover:bg-primary/90",children:o?"Обновить":"Создать"})})]})})]})]})]}),a?e.jsx("div",{className:"text-white/60 text-center py-12",children:"Загрузка привычек..."}):r?e.jsxs("div",{className:"text-red-400 text-center py-12",children:["Ошибка: ",r]}):s.length===0?e.jsxs("div",{className:"text-center py-12 glass-panel p-8",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-white/30 mb-4 block",children:"checklist"}),e.jsx("p",{className:"text-white/60",children:"Нет привычек. Создайте первую привычку чтобы начать!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:s.map(u=>{const v=new Date().toISOString().split("T")[0],P={daily:"Ежедневно",weekdays:"По будням",every_n_days:u.everyNDays?`Каждые ${u.everyNDays} дн.`:"Каждые N дней",custom:"Выборочно"},A=u.datesCompleted?.includes(v)||!1,b={low:"Низкая",medium:"Средняя",hard:"Высокая"},T={low:"text-green-400",medium:"text-yellow-400",hard:"text-red-400"};return e.jsx("div",{"data-testid":"habit-card",className:"magic-card group",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("button",{onClick:()=>y(u.id),className:"mb-4 transition-transform hover:scale-110",children:e.jsx("span",{className:`material-symbols-outlined text-6xl ${A?"text-accent":"text-white/50"}`,children:A?"check_circle":"radio_button_unchecked"})}),e.jsx("h2",{className:"text-xl font-bold tracking-wider text-white",children:u.title}),u.description&&e.jsx("p",{className:"text-white/60 text-sm mt-2",children:u.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-center",children:[u.frequency&&e.jsx("span",{className:"px-2 py-1 text-xs rounded bg-blue-500/20 text-blue-300 border border-blue-500/30",children:P[u.frequency]}),u.difficulty&&e.jsx("span",{className:`px-2 py-1 text-xs rounded bg-white/10 border border-white/20 ${T[u.difficulty]}`,children:b[u.difficulty]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>k(u.id),"aria-label":`Редактировать привычку "${u.title}"`,className:"px-3 py-1 text-xs rounded bg-white/10 text-white/80 hover:bg-white/20 transition-colors",children:"Изменить"}),e.jsx("button",{onClick:()=>E(u.id),"aria-label":`Удалить привычку "${u.title}"`,className:"px-3 py-1 text-xs rounded bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-colors",children:"Удалить"})]})]})},u.id)})})]})})};async function ms(t){if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")return console.warn("Perplexity service not available in development, returning mock data"),{tasks:[{title:"Изучить основы",done:!1},{title:"Практика",done:!1},{title:"Создать проект",done:!1}]};const a=await fetch("/.netlify/functions/perplexity",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t})}),r=await a.text();let l;try{l=JSON.parse(r)}catch{l=null}if(l&&typeof l=="object"){const i=l;if("error"in i)throw new Error(String(i.error));if("result"in i)return i.result}if(!a.ok)throw new Error(`Perplexity proxy error: ${a.status}`);return l}function gl(t){if(!t||typeof t!="object")return!1;const s=t;return!(typeof s.title!="string"||s.title.trim().length===0||s.title.length>200||s.description!==void 0&&typeof s.description!="string"||typeof s.description=="string"&&s.description.length>1e3||s.week_estimate!==void 0&&(typeof s.week_estimate!="number"||s.week_estimate<0||s.week_estimate>52)||s.day_estimate!==void 0&&(typeof s.day_estimate!="number"||s.day_estimate<0||s.day_estimate>365))}function fl(t){const s=new Set,a=[];for(const r of t){let l=r.title.toLowerCase().trim();l=l.replace(/[\p{P}\p{S}]+/gu," "),l=l.replace(/\s+/g," ").trim();const i=["the","a","an","to","for","and","of","in","on","at","complete","task","задача","срочная","срочно"];if(l=l.split(" ").filter(n=>!i.includes(n)).join(" "),s.has(l))continue;const m=.7;let o=!1;for(const n of s)if(n&&jl(l,n)>=m){o=!0;break}o||(s.add(l),a.push(r))}return a}function jl(t,s){const a=new Set(t.split(/\s+/)),r=new Set(s.split(/\s+/)),l=new Set([...a].filter(m=>r.has(m))),i=new Set([...a,...r]);return i.size===0?0:l.size/i.size}function bl(t){const s={...t};return(!s.description||s.description.length<10)&&(s.description=`Выполнить: ${s.title.toLowerCase()}`),s.acceptanceCriteria||(s.acceptanceCriteria=`Задача считается выполненной, если: ${s.title.toLowerCase()}`),!s.week_estimate&&!s.day_estimate&&(s.title.split(/\s+/).length>10?s.week_estimate=2:s.week_estimate=1),s}function Nl(t,s){return t.map((r,l)=>{let i="medium";const m=r.title.toLowerCase();if(["срочно","срочная","сроч","сегодня","завтра","асап","важно","критично","urgent","asap"].some(x=>m.includes(x))||l===0?i="high":l<3?i="medium":i="low",s?.deadline){const x=new Date(s.deadline),h=new Date;Math.ceil((x.getTime()-h.getTime())/(1e3*60*60*24))<=7&&l<5&&(i="high")}return{...r,priority:i}})}function wl(t){return t.filter(s=>!(!gl(s)||[/^(task|задача|шаг)\s*\d+$/i,/^(todo|to do|сделать)$/i,/^\.{3,}/,/^placeholder/i].some(r=>r.test(s.title))||s.title.length<3))}function vl(t,s){return s?t.map(a=>{const r={...a};return s.tags&&s.tags.length>0&&(r.description||(r.description=""),r.description=`${r.description}

Связанные темы: ${s.tags.join(", ")}`),s.preferredDifficulty&&(s.preferredDifficulty==="easy"?r.week_estimate&&r.week_estimate>2&&(r.week_estimate=Math.ceil(r.week_estimate*.7)):s.preferredDifficulty==="hard"&&r.week_estimate&&r.week_estimate<4&&(r.week_estimate=Math.ceil(r.week_estimate*1.5))),r}):t}function Te(t,s){let a=wl(t);return a=fl(a),a=a.map(bl),a=vl(a,s),Nl(a,s)}const yl=1e4;function Re(){return crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2)}function kl(t){const s=[];for(const a of t){const r=a.replace(/^[-*•]\s*/,"").replace(/^\d+\.\s*/,"").trim();r.length>5&&s.push({id:Re(),title:r.slice(0,100),description:r.length>100?r.slice(100):void 0,done:!1})}return s}function Cl(t){const s=t.toLowerCase();return/(экзамен|сдать|тест|контрольная|теормин|зачет|провести)/.test(s)?"study":/(пожать|жать|пробежать|трениров|kg|кг|подтянуть|бег|тренировка)/.test(s)?"fitness":/(проект|deploy|запустить|сделать сайт|приложение|реализовать)/.test(s)?"project":/(привычк|habit|ежедневно|ежеднев)/.test(s)?"habit":"general"}function I(t,s,a,r=!1){return{id:Re(),title:t.slice(0,120),description:s?s.slice(0,400):void 0,week_estimate:r?void 0:typeof a=="number"?a:1,day_estimate:r?typeof a=="number"?a:1:void 0,acceptanceCriteria:s?`Можно проверить, если: ${s.split(/[.\n]+/)[0].slice(0,120)}`:void 0,done:!1}}function Sl(t,s,a){const r=Cl(t),l=[];r==="study"?(l.push(I("Собрать материалы для изучения","Найти лекции, конспекты и прошлые тесты по теме")),l.push(I("Разбить тему на разделы","Составить список ключевых тем, которые нужно пройти")),l.push(I("Изучить первый раздел","Прочитать конспект/лекцию и сделать заметки")),l.push(I("Решить практические задачи","Решить 3-5 типовых задач по пройденному материалу")),l.push(I("Проверка и повторение","Пройти пробный тест или составить контрольные вопросы"))):r==="fitness"?(l.push(I("Оценить текущее состояние","Сделать замер и записать текущие показатели")),l.push(I("Составить план тренировок","Определить частоту и базовые упражнения")),l.push(I("Выполнить базовую тренировку","Сделать запланированную тренировку и записать результаты")),l.push(I("Добавить вспомогательные упражнения","Включить упражнения на поддержку основных мышечных групп")),l.push(I("Отслеживать прогресс","Записывать веса/повторы после каждой тренировки"))):r==="project"?(l.push(I("Определить требование","Записать, что должно делать приложение/функция")),l.push(I("Спланировать MVP","Выделить минимальный функционал для первого релиза")),l.push(I("Реализовать базовую функциональность","Написать и протестировать основной флоу")),l.push(I("Протестировать и деплоить","Провести ручное тестирование и развернуть")),l.push(I("Собрать фидбек","Собрать отзывы и запланировать итерации"))):r==="habit"?(l.push(I("Определить триггер и цель","Записать когда и при каком условии выполнять привычку")),l.push(I("Установить напоминание","Добавить ежедневное напоминание в календарь")),l.push(I("Выполнять привычку 7 дней подряд","Следить за выполнением и отмечать в дневнике")),l.push(I("Оценить прогресс","Проанализировать результаты через неделю")),l.push(I("Уточнить и масштабировать","Скорректировать сложность или частоту при необходимости"))):(l.push(I("Прояснить цель","Чётко сформулировать, чего именно хотите достичь")),l.push(I("Собрать ресурсы","Найти статьи, видео и инструменты, которые помогут")),l.push(I("Разбить на темы","Разделить цель на логические блоки и приоритеты")),l.push(I("Выполнить первый блок","Сфокусироваться на первом блоке и завершить")),l.push(I("Проверка результата","Оценить выполненное и решить следующую задачу")));let i=0;const m=["Дополнить материал","Сделать короткое упражнение","Сделать самооценку","Запланировать следующую итерацию"];for(;l.length<s;){const o=m[i%m.length];l.push(I(o,`Выполнить: ${o.toLowerCase()}`)),i++}return a&&l.forEach(o=>{o.day_estimate=o.week_estimate?o.week_estimate*7:o.day_estimate??1,o.week_estimate=void 0}),l}function Tl(t){return!!t&&typeof t=="object"&&"title"in t}function Us(t){if(!t||typeof t!="object")return null;const s=t;if(Array.isArray(s.tasks)&&s.tasks.length>0){const a=[];for(const r of s.tasks)if(Tl(r)){const l=r;a.push({id:Re(),title:String(l.title).slice(0,120),description:typeof l.description=="string"?l.description:void 0,week_estimate:typeof l.week_estimate=="number"?l.week_estimate:void 0,day_estimate:typeof l.day_estimate=="number"?l.day_estimate:void 0,acceptanceCriteria:typeof l.acceptance_criteria=="string"?l.acceptance_criteria:typeof l.acceptanceCriteria=="string"?l.acceptanceCriteria:void 0,done:!1})}if(a.length>0)return a}return null}function hs(t,s){const a=Us(t);if(a)return a;let r;if(typeof t=="string")r=t;else try{r=JSON.stringify(t)}catch{r=s}try{const m=JSON.parse(r),o=Us(m);if(o)return o}catch(m){console.warn("splitGoal: response not json",m)}const l=(r||s||"").split(/\r?\n/).map(m=>m.trim()).filter(Boolean),i=kl(l);return i.length>0?i:null}async function us(t,s){if(!t||t.trim().length===0)return[];const a=[];s?.baseline&&a.push(`baseline=${s.baseline}`),s?.unit&&a.push(`unit=${s.unit}`),s?.frequency&&a.push(`frequency=${s.frequency}`),s?.constraints&&a.push(`constraints=${s.constraints}`),s?.targetDate&&a.push(`target_date=${s.targetDate}`);const r=a.length>0?`Контекст: ${a.join("; ")}.`:"";let l=!1;try{const b=t.toLowerCase();if((b.includes("завтра")||b.includes("сегодня")||b.includes("срочно")||b.includes("утром"))&&(l=!0),!l&&s?.targetDate){const T=new Date(String(s.targetDate));if(!Number.isNaN(T.getTime())){const L=new Date,w=T.getTime()-L.getTime();Math.ceil(w/(1e3*60*60*24))<=3&&(l=!0)}}}catch{l=!1}const i=r?`${r} Используй контекст при наличии, но не ограничивай план, если контекст не задан.`:"Контекст не задан — предложи универсальные шаги.",m=t.split(/\s+/).filter(Boolean).length,o=Math.max(1,t.split(/[.\n!?]+/).map(b=>b.trim()).filter(Boolean).length);let n=5;s?.forceDaily&&(l=!0),l?n=Math.max(5,Math.min(12,o+2)):n=Math.max(3,Math.min(12,Math.ceil(m/40)+Math.floor(o/2)));const x=s?.tempo??"normal";n=Math.max(1,Math.round(n*(x==="conservative"?.7:x==="aggressive"?1.4:1)));const f=x==="conservative"?"темп: консервативный — небольшие стабильные шаги.":x==="aggressive"?"темп: агрессивный — более мелкие и частые шаги.":"темп: нормальный.",N=s?.tags&&s.tags.length>0?`

Теги цели: ${s.tags.join(", ")}. Учитывай эти темы при формировании задач.`:"",k=s?.preferredDifficulty?`

Предпочтительная сложность: ${s.preferredDifficulty==="easy"?"лёгкая":s.preferredDifficulty==="medium"?"средняя":"высокая"}.`:"",E=l?`Ты — ассистент, который разбивает любую цель на очень короткие, выполнимые микро‑задачи (дневные). ${i}${N}${k} Требования к ответу:
1) Верни МИНИМУМ ${n} микро‑задач, упорядоченных по дням (последовательность выполнения).
2) Для каждой подзадачи верни: title (коротко), description (1-2 предложения), day_estimate (число дней, обычно 1), acceptance_criteria (как проверить, выполнена ли подзадача), priority (high/medium/low).
3) Сделай шаги практическими и проверяемыми, избегай аморфных формулировок. Не просто перефразируй цель, а разбей на конкретные действия.
4) Верни STRICT JSON: {"tasks":[{"title":"...","description":"...","day_estimate":1,"acceptance_criteria":"...","priority":"high"}]}.
${f}

Описание цели:
${t}`:`Ты — ассистент, который разбивает любую цель на короткие, понятные и выполнимые шаги по неделям. ${i}${N}${k} Требования к ответу:
1) Верни МИНИМУМ ${n} шагов, упорядоченных последовательно.
2) Для каждой подзадачи верни: title (коротко), description (1-2 предложения), week_estimate (число недель), acceptance_criteria (как проверить выполнение), priority (high/medium/low).
3) Делай шаги практическими, конкретными и проверяемыми. Не просто перефразируй цель.
4) Верни STRICT JSON: {"tasks":[{"title":"...","description":"...","week_estimate":1,"acceptance_criteria":"...","priority":"medium"}]}.
${f}

Описание цели:
${t}`,y=[];l?(y.push(E),y.push(`Верни ТОЛЬКО валидный JSON в формате {"tasks":[{"title":"...","description":"...","day_estimate":1}]} без лишних пояснений.
Описание:
${t}`),y.push(`Если предыдущий ответ не был валидным JSON, верни корректный JSON строго по схеме: {"tasks": [{"title":"...","description":"...","day_estimate":1}]}.
Описание:
${t}`)):(y.push(E),y.push(`Верни ТОЛЬКО валидный JSON в формате {"tasks":[{"title":"...","description":"...","week_estimate":1}]} без лишних пояснений.
Описание:
${t}`),y.push(`Если предыдущий ответ не был валидным JSON, верни корректный JSON строго по схеме: {"tasks": [{"title":"...","description":"...","week_estimate":1}]}.
Описание:
${t}`));function u(b,T,L){const w=[...b];for(const D of b){if(w.length>=L)break;const p=(D.description||"").split(/[.\n;:\-–—]+/).map(C=>C.trim()).filter(Boolean);for(const C of p){if(w.length>=L)break;C.length>10&&w.push({id:Re(),title:C.slice(0,120),description:void 0,done:!1})}}if(w.length>=L)return w;const _=T.split(/[.\n!?]+/).map(D=>D.trim()).filter(Boolean);for(const D of _){if(w.length>=L)break;D.length>10&&w.push({id:Re(),title:D.slice(0,120),description:void 0,done:!1})}if(w.length>=L)return w;const M=["Сформировать список ключевых тем и материалов для изучения","Разбить тему на подпункты и изучить первый подпункт","Прочитать конспект/лекцию по теме и сделать краткие заметки","Выполнить практическое задание или решить примерные задачи","Повторить выученное и сделать самопроверку"];let F=0;for(;w.length<L;){const D=M[F%M.length];w.push({id:Re(),title:D,description:void 0,done:!1}),F++}return w}async function v(){for(let b=0;b<y.length;b++){const T=y[b];try{const w=await Promise.race([ms(T),new Promise((M,F)=>setTimeout(()=>F(new Error("Perplexity timeout")),yl))]),_=hs(w,t);if(_&&_.length>0)return _}catch(w){console.warn(`splitGoal: attempt ${b+1} failed:`,w)}const L=Math.min(1e3,200*Math.pow(2,b));await new Promise(w=>setTimeout(w,L))}return null}try{const b=await v();if(b&&b.length>0){if(b.length===1&&b[0].title.trim().length>0&&t.trim().length>0&&(b[0].title.trim().toLowerCase()===t.trim().toLowerCase()||t.trim().toLowerCase().includes(b[0].title.trim().toLowerCase())))try{const _=l?"day_estimate":"week_estimate",M=`НЕ ПОВТОРЯЙ исходную формулировку. Разбей цель на минимум ${n} конкретных, проверяемых шагов. Для каждой подзадачи верни title, description, ${_} и acceptance_criteria. Пример правильного элемента: {"title":"Прочитать лекцию 1","description":"Просмотреть лекцию и выписать определения","${_}":1,"acceptance_criteria":"Есть записи по ключевым определениям"}. Верни STRICT JSON: {"tasks":[...]}.

Описание цели:
${t}`,F=await ms(M),D=hs(F,t);if(D&&D.length>=n){const $={goalText:t,tags:s?.tags,deadline:s?.targetDate,userHistorySummary:s?.userHistorySummary,preferredDifficulty:s?.preferredDifficulty,relatedGoals:s?.relatedGoals};return Te(D,$)}}catch(_){console.warn("splitGoal: strict attempt failed",_)}if(b.length>=n){const _={goalText:t,tags:s?.tags,deadline:s?.targetDate,userHistorySummary:s?.userHistorySummary,preferredDifficulty:s?.preferredDifficulty,relatedGoals:s?.relatedGoals};return Te(b,_)}const L=u(b,t,n);if(L.length>=n){const _={goalText:t,tags:s?.tags,deadline:s?.targetDate,userHistorySummary:s?.userHistorySummary,preferredDifficulty:s?.preferredDifficulty,relatedGoals:s?.relatedGoals};return Te(L,_)}try{const M=`Разверни и разбей существующие задачи до как минимум ${n} коротких выполнимых шагов. Верни STRICT JSON формата: {"tasks":[{"title":"...","description":"...","${l?"day_estimate":"week_estimate"}":1}]}.
 
 Существующие задачи:
 ${JSON.stringify(b)}
 
 Описание цели:
 ${t}`,F=await ms(M),D=hs(F,t);if(D&&D.length>=n){const $={goalText:t,tags:s?.tags,deadline:s?.targetDate,userHistorySummary:s?.userHistorySummary,preferredDifficulty:s?.preferredDifficulty,relatedGoals:s?.relatedGoals};return Te(D,$)}}catch(_){console.warn("splitGoal: expand attempt failed",_)}const w={goalText:t,tags:s?.tags,deadline:s?.targetDate,userHistorySummary:s?.userHistorySummary,preferredDifficulty:s?.preferredDifficulty,relatedGoals:s?.relatedGoals};return Te(u(b,t,n),w)}}catch(b){console.warn("splitGoal: retries failed",b)}const P=Sl(t,n,l),A={tags:s?.tags,deadline:s?.targetDate,userHistorySummary:s?.userHistorySummary,preferredDifficulty:s?.preferredDifficulty,relatedGoals:s?.relatedGoals};return Te(P,A)}const Dl=()=>{const t=X(),{items:s,loading:a}=q(j=>j.goals),r=q(j=>j.user.me?.id),[l,i]=ks(),[m,o]=c.useState(!1),[n,x]=c.useState(null),[h,f]=c.useState(""),[N,k]=c.useState(""),[E,y]=c.useState(0),[u,v]=c.useState([]),[P,A]=c.useState(!1),[b,T]=c.useState(null),[L,w]=c.useState(!0),[_,M]=c.useState([]),[F,D]=c.useState(!1);c.useEffect(()=>{r&&t(Je(r))},[t,r]),c.useEffect(()=>{l.get("create")==="true"&&($(),i({}))},[l,i]);const $=j=>{if(j){const W=s.find(V=>V.id===j);W&&(x(j),f(W.title),k(W.detailedDescription||""),y(W.progress||0),v(W.tasks||[]))}else x(null),f(""),k(""),y(0),v([]);o(!0)},p=async()=>{if(!N.trim()){d.error("Введите подробное описание для генерации задач");return}A(!0),T(null);try{let j=await us(N);if(!j||j.length<3)try{const V=await us(N,{forceDaily:!0,tempo:"normal"});V&&V.length>=1&&(j=V)}catch(W){console.warn("GoalsPage: retry generation failed",W)}v(j),d.success(`Сгенерировано ${j?.length||0} подзадач`)}catch{d.error("Ошибка при генерации задач")}finally{A(!1)}},C=async(j,W)=>{if(!W){v(J=>J.map(g=>g.id===j?{...g,done:!g.done}:g));return}if(!r)return;const V=s.find(J=>J.id===W);if(!V?.tasks)return;const fe=V.tasks.map(J=>J.id===j?{...J,done:!J.done}:J),as=fe.length>0?Math.round(fe.filter(J=>J.done).length/fe.length*100):0;try{await t(Fs({id:W,data:{tasks:fe,progress:as}})).unwrap(),d.success("Задача обновлена!")}catch(J){d.error("Не удалось обновить задачу"),console.error("Failed to toggle task:",J)}},z=async()=>{if(!(u.length>0||!N.trim())){A(!0),T(null);try{const j=await us(N);j&&j.length>0&&v(j)}catch(j){const W=j instanceof Error?j.message:String(j);T(W)}finally{A(!1)}}},K=async()=>{if(!h.trim()){d.error("Введите название цели");return}const j=u.length>0?Math.round(u.filter(W=>W.done).length/u.length*100):E;try{await z(),n&&r?(await t(Fs({id:n,data:{title:h,detailedDescription:N,progress:j,tasks:u}})).unwrap(),d.success("Цель обновлена!")):(await t(Ia({title:h,detailedDescription:N,progress:j,completed:!1,tasks:u})).unwrap(),d.success("Цель добавлена!")),o(!1),x(null),f(""),k(""),y(0),v([])}catch{d.error("Ошибка при сохранении цели")}},ne=async j=>{try{await t(Ma(j)).unwrap(),d.success("Цель удалена")}catch{d.error("Ошибка при удалении цели")}};return e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Цели"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Ставьте амбициозные цели и отслеживайте прогресс."})]}),e.jsxs(ve,{open:m,onOpenChange:o,children:[e.jsx(Fe,{asChild:!0,children:e.jsx("button",{"data-testid":"add-goal-btn",onClick:()=>$(),className:"flex items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-accent/10 text-accent text-sm font-bold leading-normal tracking-[0.015em] border border-accent/80 shadow-glow-gold hover:shadow-glow-gold-hover transition-shadow duration-300",children:e.jsx("span",{className:"truncate",children:"+ Добавить цель"})})}),e.jsxs(he,{className:"glass-panel border-white/20 max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:n?"Редактировать цель":"Создать новую цель"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"goal-title",className:"text-white/80 text-sm mb-2 block",children:"Название"}),e.jsx(G,{id:"goal-title",value:h,onChange:j=>f(j.target.value),className:"bg-white/5 border-white/10 text-white",placeholder:"Например: Выучить TypeScript"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"goal-detailed",className:"text-white/80 text-sm mb-2 block",children:"Описание"}),e.jsx(Se,{id:"goal-detailed",value:N,onChange:j=>k(j.target.value),className:"bg-white/5 border-white/10 text-white min-h-[100px]",placeholder:"Опишите цель подробно. Можно использовать список:\\n- Шаг 1\\n- Шаг 2\\n- Шаг 3"})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:L,onChange:j=>w(j.target.checked)}),e.jsx("span",{className:"text-white/80 text-sm",children:"Предложить добавить привычки после сохранения"})]})}),e.jsx(R,{onClick:p,disabled:P||!N.trim(),className:"mt-2 bg-accent/20 text-accent hover:bg-accent/30",children:P?"Генерация...":"✨ Разбить на подзадачи"}),b&&e.jsxs("p",{className:"text-red-400 text-sm mt-2",children:["Ошибка генерации: ",b]}),u.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"text-white/80 text-sm mb-2 block",children:["Подзадачи (",u.filter(j=>j.done).length,"/",u.length," выполнено)"]}),e.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto",children:u.map(j=>e.jsxs("label",{className:"flex items-start gap-2 p-2 rounded bg-white/5 hover:bg-white/10 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j.done,onChange:()=>C(j.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-white text-sm ${j.done?"line-through text-white/50":""}`,children:j.title}),j.description&&e.jsx("p",{className:"text-white/60 text-xs mt-1",children:j.description})]})]},j.id))})]}),u.length===0&&e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"goal-progress",className:"text-white/80 text-sm mb-2 block",children:["Прогресс: ",E,"%"]}),e.jsx("input",{id:"goal-progress",type:"range",min:"0",max:"100",value:E,onChange:j=>y(Number(j.target.value)),className:"w-full"})]})]}),e.jsx(pe,{children:e.jsx(R,{onClick:K,className:"bg-primary text-white hover:bg-primary/90",children:n?"Обновить":"Создать"})})]})]})]}),a?e.jsx("div",{className:"text-white/60 text-center py-12",children:"Загрузка целей..."}):s.length===0?e.jsxs("div",{className:"text-center py-12 glass-panel p-8",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-white/30 mb-4 block",children:"flag"}),e.jsx("p",{className:"text-white/60",children:"Нет целей. Создайте первую цель чтобы начать!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(j=>{const W=j.tasks&&j.tasks.length>0;return e.jsx("div",{"data-testid":"goal-card",className:"glass-panel p-6 hover:border-primary/50 transition-all",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h3",{className:"text-white text-xl font-bold",children:j.title}),j.completed&&e.jsx("span",{className:"material-symbols-outlined text-accent",children:"check_circle"})]}),j.detailedDescription&&e.jsxs("p",{className:"text-white/60 text-sm",children:[j.detailedDescription.slice(0,100),j.detailedDescription.length>100?"...":""]}),W&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-white/70 text-xs",children:["Подзадач: ",j.tasks.filter(V=>V.done).length," / ",j.tasks.length]}),e.jsx("div",{className:"space-y-1",children:j.tasks.slice(0,3).map(V=>e.jsxs("button",{onClick:Oe=>{Oe.stopPropagation(),C(V.id,j.id)},className:"flex items-center gap-2 text-xs w-full hover:bg-white/5 p-1 rounded transition-colors",children:[e.jsx("span",{className:`material-symbols-outlined text-sm ${V.done?"text-accent":"text-white/30"}`,children:V.done?"check_circle":"radio_button_unchecked"}),e.jsxs("span",{className:`text-white/70 ${V.done?"line-through":""}`,children:[V.title.slice(0,40),V.title.length>40?"...":""]})]},V.id))}),j.tasks.length>3&&e.jsxs("p",{className:"text-white/50 text-xs ml-6",children:["+",j.tasks.length-3," ещё..."]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-white/70",children:"Прогресс"}),e.jsxs("span",{className:"text-white font-semibold",children:[j.progress||0,"%"]})]}),e.jsx("div",{className:"w-full bg-black/20 rounded-full h-2.5",children:e.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-500",style:{width:`${j.progress||0}%`,boxShadow:"0 0 8px rgba(190, 52, 213, 0.7)"}})})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:()=>$(j.id),"aria-label":`Редактировать цель "${j.title}"`,className:"flex-1 px-3 py-1 text-xs rounded bg-white/10 text-white/80 hover:bg-white/20 transition-colors",children:"Изменить"}),e.jsx("button",{onClick:()=>ne(j.id),"aria-label":`Удалить цель "${j.title}"`,className:"flex-1 px-3 py-1 text-xs rounded bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-colors",children:"Удалить"})]})]})},j.id)})})]})})},El=()=>{const t=X(),{items:s,loading:a}=q(p=>p.todos),r=q(p=>p.user.me?.id),[l,i]=c.useState(!1),[m,o]=c.useState(""),[n,x]=c.useState(""),[h,f]=c.useState(""),[N,k]=c.useState(!1),[E,y]=c.useState(null),[u,v]=c.useState(""),[P,A]=c.useState(""),[b,T]=c.useState("");c.useEffect(()=>{r&&t(gs(r))},[t,r]);const L=async()=>{if(!m.trim()){d.error("Введите название задачи");return}const{auth:p}=await de(async()=>{const{auth:z}=await import("./index-Cnf75vxI.js").then(K=>K.H);return{auth:z}},__vite__mapDeps([0,1,2])),C=p.currentUser?.uid;if(!C){d.error("Необходима авторизация");return}try{await t(wt({title:m,description:n,deadline:h,userId:C})).unwrap(),d.success("Задача добавлена!"),o(""),x(""),f(""),i(!1)}catch(z){const K=z instanceof Error?z.message:"Ошибка при создании задачи";d.error(K)}},w=p=>{y(p.id),v(p.title||""),A(p.description||""),T(p.deadline||""),k(!0)},_=async()=>{if(!E)return;const p={title:u.trim(),description:P.trim()||void 0,deadline:b||void 0};try{await t(St({id:E,data:p})).unwrap(),d.success("Задача обновлена"),k(!1)}catch(C){const z=C instanceof Error?C.message:String(C);if(z.toLowerCase().includes("permission")||z.toLowerCase().includes("insufficient")){d.error("Нет прав на обновление задачи в Firestore. Проверьте правила безопасности Firestore и опубликуйте их.");return}d.error("Не удалось сохранить изменения")}},M=async(p,C)=>{try{await t(vt({id:p,completed:C})).unwrap(),d.success(C?"Задача возвращена":"Задача выполнена!")}catch(z){const K=z instanceof Error?z.message:String(z);if(K.toLowerCase().includes("permission")||K.toLowerCase().includes("insufficient")){d.error("Нет прав на обновление задачи в Firestore. Проверьте правила безопасности Firestore и опубликуйте их.");return}d.error("Не удалось обновить задачу")}},F=async p=>{try{await t(yt(p)).unwrap(),d.success("Задача удалена")}catch(C){const z=C instanceof Error?C.message:String(C);if(z.toLowerCase().includes("permission")||z.toLowerCase().includes("insufficient")){d.error("Нет прав на удаление задачи в Firestore. Проверьте правила безопасности Firestore и опубликуйте их.");return}d.error("Ошибка при удалении задачи")}},D=s.filter(p=>!p.completed),$=s.filter(p=>p.completed);return e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Задачи"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Управляйте своими повседневными задачами."})]}),e.jsxs(ve,{open:l,onOpenChange:i,children:[e.jsx(Fe,{asChild:!0,children:e.jsx("button",{onClick:()=>i(!0),className:"flex items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-accent/10 text-accent text-sm font-bold leading-normal tracking-[0.015em] border border-accent/80 shadow-glow-gold hover:shadow-glow-gold-hover transition-shadow duration-300",children:e.jsx("span",{className:"truncate",children:"+ Добавить задачу"})})}),e.jsxs(he,{className:"glass-panel border-white/20",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:"Создать новую задачу"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"todo-title",className:"text-white/80 text-sm mb-2 block",children:"Название"}),e.jsx(G,{id:"todo-title",value:m,onChange:p=>o(p.target.value),className:"bg-white/5 border-white/10 text-white",placeholder:"Например: Купить продукты"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"todo-description",className:"text-white/80 text-sm mb-2 block",children:"Описание (опционально)"}),e.jsx(Se,{id:"todo-description",value:n,onChange:p=>x(p.target.value),className:"bg-white/5 border-white/10 text-white min-h-[80px]",placeholder:"Детали задачи..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"todo-deadline",className:"text-white/80 text-sm mb-2 block",children:"Дедлайн (опционально)"}),e.jsx(G,{id:"todo-deadline",type:"datetime-local",value:h,onChange:p=>f(p.target.value),className:"bg-white/5 border-white/10 text-white"})]})]}),e.jsx(pe,{children:e.jsx(R,{onClick:L,className:"bg-primary text-white hover:bg-primary/90",children:"Создать"})})]})]})]}),a?e.jsx("div",{className:"text-white/60 text-center py-12",children:"Загрузка задач..."}):s.length===0?e.jsxs("div",{className:"text-center py-12 glass-panel p-8",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-white/30 mb-4 block",children:"task_alt"}),e.jsx("p",{className:"text-white/60",children:"Нет задач. Создайте первую задачу чтобы начать!"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h2",{className:"text-white text-[22px] font-bold leading-tight tracking-[-0.015em] pb-4 mb-4 border-b border-white/10",children:["Активные задачи (",D.length,")"]}),D.length===0?e.jsx("div",{className:"text-white/60 text-center py-8",children:"Нет активных задач"}):e.jsx("div",{className:"flex flex-col gap-3",children:D.map(p=>e.jsxs("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 flex items-start gap-3 group hover:border-primary/30 transition-colors",children:[e.jsx("input",{className:"h-5 w-5 mt-0.5 rounded border-white/30 border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 transition-all duration-300 cursor-pointer",type:"checkbox",checked:p.completed,onChange:()=>M(p.id,p.completed)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-medium",children:p.title}),p.description&&e.jsx("p",{className:"text-white/60 text-sm mt-1",children:p.description}),p.deadline&&e.jsxs("p",{className:"text-accent text-xs mt-2",children:["📅 ",new Date(p.deadline).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(p),className:"opacity-0 group-hover:opacity-100 transition-opacity text-white/40 hover:text-accent","aria-label":"Редактировать задачу",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit"})}),e.jsx("button",{onClick:()=>F(p.id),className:"opacity-0 group-hover:opacity-100 transition-opacity text-white/40 hover:text-red-400","aria-label":"Удалить задачу",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})})]})]},p.id))})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h2",{className:"text-white text-[22px] font-bold leading-tight tracking-[-0.015em] pb-4 mb-4 border-b border-white/10",children:["Выполненные задачи (",$.length,")"]}),$.length===0?e.jsx("div",{className:"text-white/60 text-center py-8",children:"Нет выполненных задач"}):e.jsx("div",{className:"flex flex-col gap-3",children:$.map(p=>e.jsxs("div",{className:"p-4 rounded-lg bg-white/5 border border-white/10 flex items-start gap-3 group opacity-70 hover:opacity-100 transition-opacity",children:[e.jsx("input",{className:"h-5 w-5 mt-0.5 rounded border-white/30 border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 transition-all duration-300 cursor-pointer",type:"checkbox",checked:p.completed,onChange:()=>M(p.id,p.completed)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white/50 font-medium line-through",children:p.title}),p.description&&e.jsx("p",{className:"text-white/40 text-sm mt-1 line-through",children:p.description}),p.deadline&&e.jsxs("p",{className:"text-white/40 text-xs mt-2",children:["📅 ",new Date(p.deadline).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(p),className:"opacity-0 group-hover:opacity-100 transition-opacity text-white/40 hover:text-accent","aria-label":"Редактировать задачу",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit"})}),e.jsx("button",{onClick:()=>F(p.id),className:"opacity-0 group-hover:opacity-100 transition-opacity text-white/40 hover:text-red-400","aria-label":"Удалить задачу",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})})]})]},p.id))})]})]}),N&&e.jsx(ve,{open:N,onOpenChange:k,children:e.jsxs(he,{className:"glass-panel border-white/20",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:"Редактировать задачу"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-title",className:"text-white/80 text-sm mb-2 block",children:"Название"}),e.jsx(G,{id:"edit-title",value:u,onChange:p=>v(p.target.value),className:"bg-white/5 border-white/10 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-desc",className:"text-white/80 text-sm mb-2 block",children:"Описание"}),e.jsx(Se,{id:"edit-desc",value:P,onChange:p=>A(p.target.value),className:"bg-white/5 border-white/10 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-deadline",className:"text-white/80 text-sm mb-2 block",children:"Дедлайн"}),e.jsx(G,{id:"edit-deadline",type:"datetime-local",value:b,onChange:p=>T(p.target.value),className:"bg-white/5 border-white/10 text-white"})]})]}),e.jsx(pe,{children:e.jsx(R,{onClick:_,className:"bg-primary text-white",children:"Сохранить"})})]})})]})})},_l=()=>{const t=X(),{items:s,loading:a,error:r}=q(n=>n.challenges),l=q(n=>n.user.me);c.useEffect(()=>{t(Ts())},[t]);const i=async n=>{if(!l?.id){d.error("Необходимо авторизоваться");return}const x=s.find(f=>f.id===n);if(!x)return;const h=x.participants?.includes(l.id);try{h?(await t(jt({challengeId:n,userId:l.id})).unwrap(),d.success("Вы покинули вызов")):(await t(bt({challengeId:n,userId:l.id})).unwrap(),d.success("Вы присоединились к вызову!"))}catch{d.error("Произошла ошибка")}},m=async n=>{if(!l?.id){d.error("Необходимо авторизоваться");return}try{await t(gt({challengeId:n,userId:l.id})).unwrap(),d.success("День отмечен!")}catch{d.error("Не удалось отметить день")}},o=async n=>{if(!l?.id){d.error("Необходимо авторизоваться");return}try{await t(ft({challengeId:n,userId:l.id})).unwrap(),d.success("Отметка отменена")}catch{d.error("Не удалось отменить отметку")}};return e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Вызовы"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Присоединяйтесь к вызовам сообщества и соревнуйтесь с друзьями."})]}),a&&s.length===0?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):r?e.jsx("div",{className:"glass-panel p-8 text-center",children:e.jsx("p",{className:"text-red-400",children:r})}):s.length===0?e.jsxs("div",{className:"text-center py-12 glass-panel p-8",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-white/30 mb-4 block",children:"shield"}),e.jsx("p",{className:"text-white/60",children:"Нет доступных вызовов"}),e.jsx("p",{className:"text-white/40 text-sm mt-2",children:"Вызовы будут добавлены администраторами."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(n=>{const x=l?.id&&n.participants?.includes(l.id),h=l?.id?n.dailyChecks?.[l.id]??[]:[],f=n.days>0?h.length/n.days*100:0,N=new Date().toISOString().split("T")[0],k=h.includes(N);return e.jsxs("div",{"data-testid":"challenge-card",className:"glass-panel p-6 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h3",{className:"text-white text-xl font-bold",children:n.title}),x&&e.jsx("span",{className:"text-xs bg-accent/20 text-accent px-2 py-1 rounded-full",children:"Участвуете"})]}),n.description&&e.jsx("p",{className:"text-white/60 text-sm",children:n.description}),e.jsxs("div",{className:"flex items-center gap-2 text-white/80 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-base",children:"schedule"}),e.jsxs("span",{children:[n.days," дней"]})]}),x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/80 text-sm",children:"Прогресс"}),e.jsxs("span",{className:"text-white text-sm font-semibold",children:[h.length," / ",n.days]})]}),e.jsx("div",{className:"w-full bg-white/10 rounded-full h-2",children:e.jsx("div",{className:"bg-accent h-2 rounded-full transition-all",style:{width:`${Math.min(f,100)}%`}})})]}),e.jsx("div",{className:"flex gap-2",children:k?e.jsxs("button",{onClick:()=>o(n.id),className:"flex-1 px-4 py-2 rounded-lg bg-yellow-500/10 text-yellow-400 hover:bg-yellow-500/20 transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"undo"}),"Отменить"]}):e.jsxs("button",{"data-testid":"challenge-checkin-btn",onClick:()=>m(n.id),className:"flex-1 px-4 py-2 rounded-lg bg-accent/20 text-accent hover:bg-accent/30 transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),"Отметить день"]})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white/60 text-xs",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"group"}),e.jsxs("span",{children:[n.participants?.length??0," участников"]})]}),e.jsx("button",{onClick:()=>i(n.id),className:`w-full px-4 py-2 rounded-lg transition-colors ${x?"bg-red-500/10 text-red-400 hover:bg-red-500/20":"bg-accent text-white hover:bg-accent/80"}`,children:x?"Покинуть":"Присоединиться"})]},n.id)})})]})})},Ue=typeof window<"u"?window.localStorage:null,Rs=new Map,$s=t=>`motify_settings_${t}`;function Vs(t){if(!t)return null;const s=$s(t),a=Ue?.getItem(s)??Rs.get(s);if(!a)return null;try{return JSON.parse(a)}catch{return null}}function Rl(t,s){if(!t)return s;const a=$s(t),r=JSON.stringify(s);return Ue?Ue.setItem(a,r):Rs.set(a,r),s}const Hs={notifications:!0,theme:"dark",profileVisibility:"public"},De={async getSettings(t){return Vs(t)??Hs},async updateSettings(t,s){const r={...Vs(t)??Hs,...s};return Rl(t,r),r},async deleteAccount(t){if(!t)return;const{auth:s}=await de(async()=>{const{auth:h}=await import("./index-Cnf75vxI.js").then(f=>f.H);return{auth:h}},__vite__mapDeps([0,1,2])),{deleteUser:a}=await de(async()=>{const{deleteUser:h}=await import("./vendor-CEayKMPr.js").then(f=>f.bj);return{deleteUser:h}},[]),{collection:r,query:l,where:i,getDocs:m,deleteDoc:o}=await de(async()=>{const{collection:h,query:f,where:N,getDocs:k,deleteDoc:E}=await import("./vendor-CEayKMPr.js").then(y=>y.bk);return{collection:h,query:f,where:N,getDocs:k,deleteDoc:E}},[]),{db:n}=await de(async()=>{const{db:h}=await import("./index-Cnf75vxI.js").then(f=>f.H);return{db:h}},__vite__mapDeps([0,1,2])),x=s.currentUser;if(!x)throw new Error("No authenticated user");if(x.uid!==t)throw new Error("User ID mismatch");try{const h=["habits","goals","todos","challenges","settings"];for(const N of h){const k=l(r(n,N),i("userId","==",t)),y=(await m(k)).docs.map(u=>o(u.ref));await Promise.all(y)}await a(x),[$s(t),`motify_habits_${t}`,`motify_goals_${t}`,`motify_todos_${t}`,"motify_challenges","motify_groups"].forEach(N=>{Ue?Ue.removeItem(N):Rs.delete(N)})}catch(h){if(h&&typeof h=="object"&&"code"in h&&h.code==="auth/requires-recent-login"){const f=new Error("Для удаления аккаунта требуется повторный вход");throw f.code="auth/requires-recent-login",f}throw h}},async reauthenticate(t,s){const{auth:a}=await de(async()=>{const{auth:o}=await import("./index-Cnf75vxI.js").then(n=>n.H);return{auth:o}},__vite__mapDeps([0,1,2])),{reauthenticateWithCredential:r,EmailAuthProvider:l}=await de(async()=>{const{reauthenticateWithCredential:o,EmailAuthProvider:n}=await import("./vendor-CEayKMPr.js").then(x=>x.bj);return{reauthenticateWithCredential:o,EmailAuthProvider:n}},[]),i=a.currentUser;if(!i?.email)throw new Error("No authenticated user");const m=l.credential(t,s);await r(i,m)}},$l=()=>{const t=X(),s=ie(),a=q(b=>b.user.me),[r,l]=c.useState(null),[i,m]=c.useState(""),[o,n]=c.useState(""),[x,h]=c.useState(!1),[f,N]=c.useState(!1),[k,E]=c.useState("");c.useEffect(()=>{a?.id&&De.getSettings(a.id).then(b=>{l(b),m(b.displayName||a.name||""),n(b.photoURL||a.photoURL||"")})},[a]);const y=async()=>{if(a?.id){if(!i.trim()||i.length<2){d.error("Имя должно содержать минимум 2 символа");return}h(!0);try{await t(Fa({name:i,photoURL:o})).unwrap(),await De.updateSettings(a.id,{displayName:i,photoURL:o}),d.success("Профиль обновлён!")}catch{d.error("Ошибка при обновлении профиля")}finally{h(!1)}}},u=async()=>{if(!a?.id||!r)return;const b=!r.notifications;try{const T=await De.updateSettings(a.id,{notifications:b});l(T),d.success(`Уведомления ${b?"включены":"отключены"}`)}catch{d.error("Ошибка при обновлении настроек")}},v=async b=>{if(a?.id)try{const T=await De.updateSettings(a.id,{profileVisibility:b});l(T),d.success(`Профиль ${b==="public"?"публичный":"приватный"}`)}catch{d.error("Ошибка при изменении видимости")}},P=async()=>{if(!(!a?.id||!window.confirm("Вы уверены, что хотите удалить аккаунт? Все данные будут безвозвратно удалены из Firebase."))){h(!0);try{await De.deleteAccount(a.id),await t(Tt()).unwrap(),Ge("Аккаунт успешно удалён"),s("/login")}catch(T){T&&typeof T=="object"&&"code"in T&&T.code==="auth/requires-recent-login"?(d.error("Для удаления аккаунта требуется повторный вход"),N(!0)):me(T,{context:"Delete Account"})}finally{h(!1)}}},A=async()=>{if(!a?.email||!k){d.error("Введите пароль");return}h(!0);try{await De.reauthenticate(a.email,k),N(!1),E(""),Ge("Повторная аутентификация успешна. Попробуйте удалить аккаунт снова.")}catch(b){me(b,{context:"Reauthenticate"})}finally{h(!1)}};return r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-xl font-bold mb-4",children:"Профиль"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"displayName",className:"text-white/80 text-sm mb-2 block",children:"Имя"}),e.jsx(G,{id:"displayName",value:i,onChange:b=>m(b.target.value),className:"bg-white/5 border-white/10 text-white",placeholder:"Ваше имя"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"photoURL",className:"text-white/80 text-sm mb-2 block",children:"URL аватара"}),e.jsx(G,{id:"photoURL",value:o,onChange:b=>n(b.target.value),className:"bg-white/5 border-white/10 text-white",placeholder:"https://example.com/avatar.jpg"})]}),e.jsx(R,{onClick:y,disabled:x,className:"bg-primary text-white hover:bg-primary/90",children:x?"Сохранение...":"Сохранить профиль"})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-xl font-bold mb-4",children:"Уведомления"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80",children:"Получать уведомления"}),e.jsx("p",{className:"text-white/60 text-sm",children:"Включить или отключить уведомления"})]}),e.jsx("button",{onClick:u,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.notifications?"bg-primary":"bg-white/20"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.notifications?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-xl font-bold mb-4",children:"Приватность"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"visibility",className:"text-white/80 text-sm mb-2 block",children:"Видимость профиля"}),e.jsxs(fs,{onValueChange:v,defaultValue:r.profileVisibility,children:[e.jsx(Ye,{id:"visibility",className:"bg-white/5 border-white/10 text-white",children:e.jsx(js,{placeholder:"Выберите видимость"})}),e.jsxs(Ke,{className:"bg-[#1a1f2e] border-white/10",children:[e.jsx(oe,{value:"public",className:"text-white hover:bg-white/10",children:"Публичный"}),e.jsx(oe,{value:"private",className:"text-white hover:bg-white/10",children:"Приватный"})]})]})]})]}),e.jsxs("div",{className:"glass-panel p-6 border-red-500/20",children:[e.jsx("h2",{className:"text-red-400 text-xl font-bold mb-4",children:"Опасная зона"}),e.jsx("p",{className:"text-white/60 text-sm mb-4",children:"Удаление аккаунта приведёт к полной потере всех данных (привычки, цели, настройки). Это действие необратимо."}),e.jsx(R,{"data-testid":"delete-account-btn",onClick:P,disabled:x,className:"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/50",children:x?"Удаление...":"Удалить аккаунт"})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{"data-testid":"reauth-dialog",className:"glass-panel p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-white text-xl font-bold mb-4",children:"Подтверждение личности"}),e.jsx("p",{className:"text-white/60 text-sm mb-4",children:"Для удаления аккаунта требуется повторный вход. Введите ваш пароль:"}),e.jsx(G,{type:"password",value:k,onChange:b=>E(b.target.value),placeholder:"Введите пароль",className:"bg-white/5 border-white/10 text-white mb-4",onKeyDown:b=>{b.key==="Enter"&&A()}}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(R,{onClick:A,disabled:x,className:"flex-1 bg-primary text-white",children:x?"Проверка...":"Подтвердить"}),e.jsx(R,{"data-testid":"reauth-cancel-btn",onClick:()=>{N(!1),E("")},disabled:x,className:"flex-1 bg-white/10 text-white",children:"Отмена"})]})]})})]}):e.jsx("div",{className:"text-white/60",children:"Загрузка настроек..."})},Pl=Ve("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function zs({className:t,variant:s,...a}){return e.jsx("div",{className:S(Pl({variant:s}),t),...a})}function Ll(){const[t,s]=c.useState(!1),[a,r]=c.useState(!0),[l,i]=c.useState(!1),[m,o]=c.useState(!0),[n,x]=c.useState(0);c.useEffect(()=>{(async()=>{try{const E=await Y.checkEmailVerified();s(E)}catch(E){console.error("Error checking email verification:",E)}finally{r(!1)}})();const k=Nt.onAuthStateChanged(E=>{E&&s(E.emailVerified)});return()=>k()},[]),c.useEffect(()=>{if(n>0){const N=setTimeout(()=>x(n-1),1e3);return()=>clearTimeout(N)}else o(!0)},[n]);const h=async()=>{i(!0);try{await Y.sendVerificationEmail(),d.success("Письмо для подтверждения отправлено на вашу почту"),o(!1),x(60)}catch(N){const k=N instanceof Error?N.message:"Не удалось отправить письмо";d.error(k)}finally{i(!1)}},f=async()=>{r(!0);try{const N=await Y.checkEmailVerified();s(N),N?d.success("Email подтвержден!"):d.info("Email еще не подтвержден")}catch(N){const k=N instanceof Error?N.message:"Ошибка проверки";d.error(k)}finally{r(!1)}};return a&&!t?e.jsx(we,{children:e.jsx(Ce,{className:"flex items-center justify-center p-6",children:e.jsx(Ee,{className:"h-6 w-6 animate-spin text-muted-foreground"})})}):e.jsxs(we,{children:[e.jsxs(Le,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ie,{className:"text-lg",children:"Подтверждение Email"}),t?e.jsxs(zs,{className:"bg-green-500",children:[e.jsx($e,{className:"mr-1 h-3 w-3"}),"Подтвержден"]}):e.jsxs(zs,{variant:"secondary",children:[e.jsx(Ze,{className:"mr-1 h-3 w-3"}),"Не подтвержден"]})]}),e.jsx(Me,{children:t?"Ваш email адрес подтвержден":"Подтвердите ваш email адрес для полного доступа ко всем функциям"})]}),!t&&e.jsxs(Ce,{className:"space-y-4",children:[e.jsxs(ss,{children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx(ts,{children:"Подтверждение email повышает безопасность вашего аккаунта и открывает доступ ко всем функциям приложения"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(R,{onClick:h,disabled:l||!m,className:"flex-1",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Отправка..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),n>0?`Отправить повторно (${n}с)`:"Отправить письмо"]})}),e.jsx(R,{variant:"outline",onClick:f,disabled:a,className:"flex-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Проверка..."]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Проверить статус"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:'Проверьте папку "Спам" если не видите письмо во входящих'})]})]})}const Il=()=>e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Настройки"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Управляйте своей учетной записью и предпочтениями."})]}),e.jsx(Ll,{}),e.jsx($l,{})]})}),Ml=()=>{const t=X(),s=ie(),{me:a,loading:r,error:l,isAuthenticated:i}=q(k=>k.user),[m,o]=c.useState(!1),[n,x]=c.useState("");c.useEffect(()=>{if(!i&&!r){s("/login");return}i&&!a&&t(Os())},[t,i,a,r,s]);const h=async()=>{try{await t(Tt()).unwrap(),d.success("Вы вышли из аккаунта"),s("/login")}catch{d.error("Ошибка при выходе")}},f=async()=>{try{await t(Oa()).unwrap(),d.success("Аккаунт удален"),s("/")}catch{d.error("Ошибка при удалении аккаунта")}},N=()=>{t(Os())};return r&&!l?e.jsx(Z,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})}):l?e.jsx(Z,{children:e.jsx("div",{className:"flex flex-col items-center justify-center py-12 gap-4",children:e.jsxs("div",{className:"glass-panel p-6 text-center max-w-md",children:[e.jsx("p",{className:"text-red-400 mb-4",children:"Ошибка загрузки профиля"}),e.jsx("p",{className:"text-white/60 mb-4 text-sm",children:l}),e.jsx("button",{onClick:N,className:"px-4 py-2 rounded-lg bg-primary text-white hover:bg-primary/80 transition-colors",children:"Повторить попытку"})]})})}):e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Профиль"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Управление вашим профилем"})]}),a?e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-xl font-bold mb-4",children:"Информация о профиле"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-center bg-no-repeat aspect-square bg-cover rounded-full size-16 border-2 border-accent/50",style:{backgroundImage:`url(${a.photoURL||"/placeholder-avatar.svg"})`}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-semibold text-lg",children:a.name||"Пользователь"}),e.jsx("p",{className:"text-white/60 text-sm",children:a.email||"Email не указан"})]})]})})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-xl font-bold mb-4",children:"Действия"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined",children:"logout"}),e.jsx("span",{children:"Выйти из аккаунта"})]}),e.jsxs(ve,{open:m,onOpenChange:o,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs("button",{"data-testid":"delete-account-btn",className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-red-500/10 text-red-400 hover:bg-red-500/20 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined",children:"delete_forever"}),e.jsx("span",{children:"Удалить аккаунт"})]})}),e.jsxs(he,{className:"glass-panel border-white/20","data-testid":"reauth-dialog",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:"Подтверждение удаления"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-white/80",children:"Для удаления аккаунта введите ваш пароль."}),e.jsx(G,{type:"password",name:"password",placeholder:"Пароль",value:n,onChange:k=>x(k.target.value),className:"bg-white/5 border-white/10 text-white"})]}),e.jsxs(pe,{children:[e.jsx(R,{variant:"outline",onClick:()=>o(!1),"data-testid":"reauth-cancel-btn",children:"Отмена"}),e.jsx(R,{variant:"destructive",onClick:f,disabled:!n,children:"Удалить навсегда"})]})]})]})]})]})]}):e.jsx("div",{className:"glass-panel p-8 text-center",children:e.jsx("p",{className:"text-white/60",children:"Профиль не найден"})})]})})},Fl=()=>{const t=X(),s=q(w=>w.user.me),a=q(w=>w.habits.items),r=q(w=>w.goals.items),l=q(w=>w.challenges.items),[i,m]=c.useState(new Date),[o,n]=c.useState({}),[x,h]=c.useState(null),f=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],N=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"];c.useEffect(()=>{s?.id&&(t(_e(s.id)),t(Je(s.id)),t(Ts()),k())},[t,s,i]);const k=()=>{try{const w={},_=i.getFullYear(),M=i.getMonth(),F=new Date(_,M+1,0).getDate();for(let D=1;D<=F;D++){const $=`${_}-${String(M+1).padStart(2,"0")}-${String(D).padStart(2,"0")}`,p=a.filter(ne=>ne.datesCompleted?.includes($)).length,C=r.filter(ne=>ne.tasks?.some(j=>j.done&&ne.updatedAt?.startsWith($))).length,z=l.filter(ne=>s?.id&&ne.dailyChecks?.[s.id]?.includes($)).length,K=p+C+z;K>0&&(w[$]={date:$,habits:p,goals:C,challenges:z,totalCompleted:K})}n(w)}catch(w){me(w,{context:"Load Calendar"})}},E=()=>{const w=i.getFullYear(),_=i.getMonth(),M=new Date(w,_,1),D=new Date(w,_+1,0).getDate();let $=M.getDay();$=$===0?6:$-1;const p=[];for(let C=0;C<$;C++)p.push(null);for(let C=1;C<=D;C++)p.push(C);return p},y=()=>{m(new Date(i.getFullYear(),i.getMonth()-1,1))},u=()=>{m(new Date(i.getFullYear(),i.getMonth()+1,1))},v=()=>{m(new Date)},P=w=>{const _=i.getFullYear(),M=i.getMonth(),F=`${_}-${String(M+1).padStart(2,"0")}-${String(w).padStart(2,"0")}`;h(F)},A=w=>w===0?"bg-white/5":w<=2?"bg-green-500/20":w<=4?"bg-green-500/40":w<=6?"bg-green-500/60":"bg-green-500/80",b=()=>{const w=i.getFullYear(),_=i.getMonth(),M=String(_+1).padStart(2,"0");let F=`Date,Habits,Goals,Challenges,Total
`;Object.values(o).forEach(C=>{F+=`${C.date},${C.habits},${C.goals},${C.challenges},${C.totalCompleted}
`});const D=new Blob([F],{type:"text/csv"}),$=URL.createObjectURL(D),p=document.createElement("a");p.href=$,p.download=`calendar-${w}-${M}.csv`,p.click(),URL.revokeObjectURL($)},T=E(),L=x?o[x]:null;return e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Календарь"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Просматривайте историю своих достижений"})]}),e.jsxs(R,{"data-testid":"calendar-export-btn",onClick:b,variant:"outline",className:"bg-accent/10 text-accent border-accent/50",children:[e.jsx("span",{className:"material-symbols-outlined text-sm mr-2",children:"download"}),"Экспорт CSV"]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{"data-testid":"calendar-month",className:"text-white text-2xl font-bold",children:[f[i.getMonth()]," ",i.getFullYear()]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{"data-testid":"calendar-prev-month",onClick:y,variant:"outline",size:"sm",children:e.jsx("span",{className:"material-symbols-outlined",children:"chevron_left"})}),e.jsx(R,{"data-testid":"calendar-today-btn",onClick:v,variant:"outline",size:"sm",children:"Сегодня"}),e.jsx(R,{"data-testid":"calendar-next-month",onClick:u,variant:"outline",size:"sm",children:e.jsx("span",{className:"material-symbols-outlined",children:"chevron_right"})})]})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:N.map(w=>e.jsx("div",{className:"text-center text-white/60 text-sm font-semibold py-2",children:w},w))}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:T.map((w,_)=>{if(w===null)return e.jsx("div",{className:"aspect-square"},`empty-${_}`);const M=i.getFullYear(),F=i.getMonth(),D=`${M}-${String(F+1).padStart(2,"0")}-${String(w).padStart(2,"0")}`,$=o[D],p=new Date().toISOString().split("T")[0]===D,C=x===D;return e.jsx("button",{"data-testid":"calendar-day","data-date":D,onClick:()=>P(w),className:`aspect-square rounded-lg p-2 transition-all hover:scale-105 ${p?"ring-2 ring-accent":""} ${C?"ring-2 ring-primary":""} ${$?A($.totalCompleted):"bg-white/5"} hover:bg-white/10`,children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("span",{className:"text-white text-sm font-semibold",children:w}),$&&e.jsx("span",{className:"text-white/60 text-xs mt-1",children:$.totalCompleted})]})},w)})})]})]}),L&&e.jsxs(we,{className:"glass-panel p-6",children:[e.jsxs("h3",{className:"text-white text-xl font-bold mb-4",children:["Детали за ",x]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary",children:"check_circle"}),e.jsx("span",{className:"text-white/80 font-semibold",children:"Привычки"})]}),e.jsx("p",{className:"text-white text-2xl font-bold",children:L.habits})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"material-symbols-outlined text-accent",children:"flag"}),e.jsx("span",{className:"text-white/80 font-semibold",children:"Цели"})]}),e.jsx("p",{className:"text-white text-2xl font-bold",children:L.goals})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"material-symbols-outlined text-yellow-500",children:"military_tech"}),e.jsx("span",{className:"text-white/80 font-semibold",children:"Челленджи"})]}),e.jsx("p",{className:"text-white text-2xl font-bold",children:L.challenges})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h3",{className:"text-white text-xl font-bold mb-4",children:"Легенда"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-white/5"}),e.jsx("span",{className:"text-white/60 text-sm",children:"Нет активности"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-green-500/20"}),e.jsx("span",{className:"text-white/60 text-sm",children:"1-2 активности"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-green-500/40"}),e.jsx("span",{className:"text-white/60 text-sm",children:"3-4 активности"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-green-500/60"}),e.jsx("span",{className:"text-white/60 text-sm",children:"5-6 активностей"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded bg-green-500/80"}),e.jsx("span",{className:"text-white/60 text-sm",children:"7+ активностей"})]})]})]})]})})},Ol=()=>{const t=X(),s=ie(),{items:a,loading:r,error:l}=q(y=>y.groups),i=q(y=>y.user.me),[m,o]=c.useState(!1),[n,x]=c.useState(""),[h,f]=c.useState(""),[N,k]=c.useState(!0);c.useEffect(()=>{t(Aa())},[t]);const E=async()=>{if(!n.trim()){me("Введите название группы",{context:"Create Group"});return}if(!i?.id){me("Необходима авторизация",{context:"Create Group"});return}try{const y=await t(qa({name:n.trim(),description:h.trim(),isPublic:N})).unwrap();Ge("Группа создана!"),o(!1),x(""),f(""),k(!0),s(`/groups/${y.id}`)}catch(y){me(y,{context:"Create Group"})}};return e.jsx(Z,{children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-white text-4xl font-black leading-tight tracking-[-0.033em]",children:"Группы"}),e.jsx("p",{className:"text-white/60 text-base font-normal leading-normal",children:"Создавайте группы и участвуйте в групповых челленджах"})]}),e.jsxs(ve,{open:m,onOpenChange:o,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(R,{className:"bg-accent text-white hover:bg-accent/80",children:[e.jsx("span",{className:"material-symbols-outlined text-sm mr-2",children:"add"})," ","Создать группу"]})}),e.jsxs(he,{className:"glass-panel border-white/20",children:[e.jsx(ue,{children:e.jsx(ge,{className:"text-white",children:"Создать новую группу"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"group-name",className:"text-white/80 text-sm mb-2 block",children:"Название"}),e.jsx(G,{id:"group-name",value:n,onChange:y=>x(y.target.value),className:"bg-white/5 border-white/10 text-white",placeholder:"Например: Марафон здоровья"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"group-description",className:"text-white/80 text-sm mb-2 block",children:"Описание"}),e.jsx(Se,{id:"group-description",value:h,onChange:y=>f(y.target.value),className:"bg-white/5 border-white/10 text-white min-h-[100px]",placeholder:"Краткое описание группы..."})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-white/80",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:y=>k(y.target.checked),className:"rounded"}),e.jsx("span",{children:"Публичная группа (видна всем)"})]})})]}),e.jsx(pe,{children:e.jsx(R,{onClick:E,className:"bg-primary text-white hover:bg-primary/90",children:"Создать"})})]})]})]}),l&&e.jsx("div",{className:"glass-panel p-4 border-red-500/50 bg-red-500/10",children:e.jsx("p",{className:"text-red-400",children:l})}),r?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):a.length===0?e.jsxs("div",{className:"text-center py-12 glass-panel p-8",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-white/30 mb-4 block",children:"groups"}),e.jsx("p",{className:"text-white/60",children:"Нет групп. Создайте первую группу!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(y=>e.jsxs("div",{className:"glass-panel p-6 hover:border-primary/50 transition-all cursor-pointer",onClick:()=>s(`/groups/${y.id}`),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-white text-xl font-bold",children:y.name}),!y.isPublic&&e.jsx("span",{className:"text-xs bg-white/10 text-white/60 px-2 py-1 rounded",children:"Приватная"})]}),y.description&&e.jsx("p",{className:"text-white/60 text-sm mb-3",children:y.description}),e.jsxs("div",{className:"flex items-center gap-2 text-white/60 text-xs",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"group"}),e.jsxs("span",{children:[y.members?.length??1," участников"]})]})]},y.id))})]})})},Al=()=>{const{id:t}=Ta(),s=ie(),[a,r]=c.useState(null),[l,i]=c.useState(!1);return c.useEffect(()=>{t&&(i(!0),Ga.getGroupById(t).then(m=>{r(m),i(!1)}).catch(m=>{me(m,{context:"Load Group"}),i(!1)}))},[t]),t?e.jsx(Z,{children:e.jsxs("div",{className:"p-6",children:[e.jsx(R,{onClick:()=>s("/groups"),className:"mb-4",children:"Вернуться к списку групп"}),l&&e.jsx("div",{children:"Загрузка..."}),!l&&!a&&e.jsx("div",{children:"Группа не найдена"}),a&&e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-white text-2xl font-bold",children:a.name}),a.description&&e.jsx("p",{className:"text-white/60 mt-2",children:a.description}),e.jsxs("div",{className:"mt-4 text-white/70",children:["Участников: ",a.members?.length??0]})]})]})}):e.jsx(Z,{children:e.jsx("div",{className:"p-6",children:"Неверный идентификатор группы"})})},ql=new Ea,Vl=()=>{const t=X();return c.useEffect(()=>{const s=t(Ua());return()=>{s.abort?.()}},[t]),e.jsx(Da,{client:ql,children:e.jsxs(Qa,{children:[e.jsx(Za,{}),e.jsx(Xa,{}),e.jsx(_a,{children:e.jsxs(Ra,{children:[e.jsx(O,{path:"/login",element:e.jsx(gr,{})}),e.jsx(O,{path:"/signup",element:e.jsx(jr,{})}),e.jsx(O,{path:"/verify-email",element:e.jsx(Nr,{})}),e.jsx(O,{path:"/email-verified",element:e.jsx(wr,{})}),e.jsx(O,{path:"/public/api",element:e.jsx(vr,{})}),e.jsx(O,{path:"/public/swagger",element:e.jsx(sr,{})}),e.jsx(O,{path:"/public/features",element:e.jsx(tr,{})}),e.jsx(O,{path:"/public/roadmap",element:e.jsx(ar,{})}),e.jsx(O,{path:"/investment",element:e.jsx(rr,{})}),e.jsx(O,{path:"/landing",element:e.jsx(Jr,{})}),e.jsx(O,{path:"/about",element:e.jsx(lr,{})}),e.jsx(O,{path:"/blog",element:e.jsx(ir,{})}),e.jsx(O,{path:"/contacts",element:e.jsx(nr,{})}),e.jsx(O,{path:"/dashboard",element:e.jsx(ce,{children:e.jsx(xl,{})})}),e.jsx(O,{path:"/habits",element:e.jsx(ce,{children:e.jsx(pl,{})})}),e.jsx(O,{path:"/goals",element:e.jsx(ce,{children:e.jsx(Dl,{})})}),e.jsx(O,{path:"/todos",element:e.jsx(ce,{children:e.jsx(El,{})})}),e.jsx(O,{path:"/challenges",element:e.jsx(ce,{children:e.jsx(_l,{})})}),e.jsx(O,{path:"/calendar",element:e.jsx(ce,{children:e.jsx(Fl,{})})}),e.jsx(O,{path:"/groups",element:e.jsx(ce,{children:e.jsx(Ol,{})})}),e.jsx(O,{path:"/groups/:id",element:e.jsx(ce,{children:e.jsx(Al,{})})}),e.jsx(O,{path:"/settings",element:e.jsx(ce,{children:e.jsx(Il,{})})}),e.jsx(O,{path:"/profile",element:e.jsx(ce,{children:e.jsx(Ml,{})})}),e.jsx(O,{path:"/",element:e.jsx(Ot,{})}),e.jsx(O,{path:"*",element:e.jsx(or,{})})]})})]})})};export{Vl as default};
